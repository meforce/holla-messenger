"use strict";(self.webpackChunkion_holla_messenger=self.webpackChunkion_holla_messenger||[]).push([[8010],{8010:(ae,y,d)=>{d.d(y,{DC:()=>oe});var v=d(4762),T=d(663),C=d.n(T),b=d(4353),I=d.n(b),e=d(3018),m=d(4490),Z=d(7635),E=d(887),P=d(393),L=d(8583),A=d(4540);function D(t,o){if(1&t&&e._UZ(0,"img",20),2&t){const n=e.oxw(3);e.MGl("id","mesdatiphoto",n.uuserid,""),e.Q6J("src",n.user.image,e.LSH)}}function M(t,o){if(1&t&&e._UZ(0,"img",21),2&t){const n=e.oxw(3);e.MGl("id","mesdatiphotoo",n.uuserid,"")}}function U(t,o){if(1&t&&(e.TgZ(0,"p",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw(3);e.MGl("id","status",n.uuserid,""),e.xp6(1),e.hij("\n",e.lcZ(2,2,"messenger.yesaviblevoicechats"),"\n")}}function k(t,o){if(1&t&&(e.TgZ(0,"p",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw(3);e.MGl("id","status",n.uuserid,""),e.xp6(1),e.hij("\n",e.lcZ(2,2,"messenger.noaviblevoicechats"),"\n")}}function N(t,o){1&t&&(e.TgZ(0,"p",16),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij("\n",e.lcZ(2,1,"messenger.serverconnecting"),"\n"))}function O(t,o){1&t&&(e.TgZ(0,"p",16),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij("\n",e.lcZ(2,1,"messenger.serverconnecterror"),"\n"))}function J(t,o){if(1&t&&(e.TgZ(0,"ion-item",13),e.TgZ(1,"ion-avatar",9),e.YNc(2,D,1,2,"img",14),e.YNc(3,M,1,1,"img",15),e.qZA(),e.TgZ(4,"ion-label",16),e.TgZ(5,"strong",17),e._uU(6),e.qZA(),e.YNc(7,U,3,4,"p",18),e.YNc(8,k,3,4,"p",18),e.YNc(9,N,3,3,"p",19),e.YNc(10,O,3,3,"p",19),e.qZA(),e.qZA()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("ngIf","none"!=n.user.image),e.xp6(1),e.Q6J("ngIf","none"==n.user.image),e.xp6(2),e.MGl("id","mesdatiname",n.uuserid,""),e.xp6(1),e.Oqu(n.user.name),e.xp6(1),e.Q6J("ngIf","yesconnect"==n.serverstatus),e.xp6(1),e.Q6J("ngIf","noconnect"==n.serverstatus),e.xp6(1),e.Q6J("ngIf","connecting"==n.serverstatus),e.xp6(1),e.Q6J("ngIf","connecterror"==n.serverstatus)}}function Y(t,o){1&t&&e._UZ(0,"ion-icon",26)}function Q(t,o){1&t&&e._UZ(0,"ion-icon",27)}function w(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",23),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).mute()}),e.YNc(1,Y,1,0,"ion-icon",24),e.YNc(2,Q,1,0,"ion-icon",25),e.qZA()}if(2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!n.mic_isveled),e.xp6(1),e.Q6J("ngIf",n.mic_isveled)}}function S(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",23),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).closeModal()}),e._UZ(1,"ion-icon",28),e.qZA()}}function B(t,o){if(1&t&&(e.TgZ(0,"ion-header",8),e.TgZ(1,"ion-toolbar"),e._UZ(2,"ion-buttons",9),e.YNc(3,J,11,8,"ion-item",10),e.TgZ(4,"ion-buttons",11),e.YNc(5,w,3,2,"ion-button",12),e.YNc(6,S,2,0,"ion-button",12),e.qZA(),e.qZA(),e.qZA()),2&t){const n=e.oxw();e.xp6(3),e.Q6J("ngIf",n.user),e.xp6(2),e.Q6J("ngIf",n.user),e.xp6(1),e.Q6J("ngIf",n.user)}}function j(t,o){1&t&&e._UZ(0,"div",29)}function R(t,o){1&t&&e._UZ(0,"div",30)}function q(t,o){if(1&t&&e._UZ(0,"img",20),2&t){const n=e.oxw(3);e.MGl("id","mesdatiphoto",n.uuserid,""),e.Q6J("src",n.user.image,e.LSH)}}function G(t,o){if(1&t&&e._UZ(0,"img",21),2&t){const n=e.oxw(3);e.MGl("id","mesdatiphotoo",n.uuserid,"")}}function H(t,o){if(1&t&&(e.TgZ(0,"p",38),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw(3);e.MGl("id","status",n.uuserid,""),e.xp6(1),e.hij("\n",e.lcZ(2,2,"messenger.yesaviblevideochats"),"\n")}}function K(t,o){if(1&t&&(e.TgZ(0,"p",38),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw(3);e.MGl("id","status",n.uuserid,""),e.xp6(1),e.hij("\n",e.lcZ(2,2,"messenger.noaviblevideochats"),"\n")}}function W(t,o){1&t&&(e.TgZ(0,"p",39),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij("\n",e.lcZ(2,1,"messenger.serverconnecting"),"\n"))}function F(t,o){1&t&&(e.TgZ(0,"p",39),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij("\n",e.lcZ(2,1,"messenger.serverconnecterror"),"\n"))}function X(t,o){if(1&t&&(e.TgZ(0,"ion-item",34),e.TgZ(1,"ion-avatar",9),e.YNc(2,q,1,2,"img",14),e.YNc(3,G,1,1,"img",15),e.qZA(),e.TgZ(4,"ion-label",16),e.TgZ(5,"strong",35),e._uU(6),e.qZA(),e.YNc(7,H,3,4,"p",36),e.YNc(8,K,3,4,"p",36),e.YNc(9,W,3,3,"p",37),e.YNc(10,F,3,3,"p",37),e.qZA(),e.qZA()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("ngIf","none"!=n.user.image),e.xp6(1),e.Q6J("ngIf","none"==n.user.image),e.xp6(2),e.MGl("id","mesdatiname",n.uuserid,""),e.xp6(1),e.Oqu(n.user.name),e.xp6(1),e.Q6J("ngIf","yesconnect"==n.serverstatus),e.xp6(1),e.Q6J("ngIf","noconnect"==n.serverstatus),e.xp6(1),e.Q6J("ngIf","connecting"==n.serverstatus),e.xp6(1),e.Q6J("ngIf","connecterror"==n.serverstatus)}}function $(t,o){1&t&&e._UZ(0,"ion-icon",42)}function z(t,o){1&t&&e._UZ(0,"ion-icon",43)}function V(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",23),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).mute()}),e.YNc(1,$,1,0,"ion-icon",40),e.YNc(2,z,1,0,"ion-icon",41),e.qZA()}if(2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!n.mic_isveled),e.xp6(1),e.Q6J("ngIf",n.mic_isveled)}}function ee(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",23),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).closeModal()}),e._UZ(1,"ion-icon",44),e.qZA()}}function ne(t,o){if(1&t&&(e.TgZ(0,"ion-header",31),e.TgZ(1,"ion-toolbar",32),e._UZ(2,"ion-buttons",9),e.YNc(3,X,11,8,"ion-item",33),e.TgZ(4,"ion-buttons",11),e.YNc(5,V,3,2,"ion-button",12),e.YNc(6,ee,2,0,"ion-button",12),e.qZA(),e.qZA(),e.qZA()),2&t){const n=e.oxw();e.Q6J("translucent",!0),e.xp6(3),e.Q6J("ngIf",n.user),e.xp6(2),e.Q6J("ngIf",n.user),e.xp6(1),e.Q6J("ngIf",n.user)}}function te(t,o){1&t&&e._UZ(0,"div",45)}function ie(t,o){1&t&&e._UZ(0,"div",46)}const x="SESSION";let oe=(()=>{class t{constructor(n,s,l,g,f,p){this.modalCtrl=n,this.localStorageService=s,this.navParams=l,this.generalFunctions=g,this.platform=f,this.dataConfig=p,this.userData={userid:"",fname:"",name:"",desc_status:"",username:"",password:"",email:"",language:"",version:"",platform:"",cordova:"",model:"",dplatform:"",uuid:"",dversion:"",manufacturer:"",disvirtual:!1,serial:"",device_uid_token:""},this.photo="none",this.serverstatus="connecting",this.mic_isveled=!1}userdata(){this.userData=this.localStorageService.getItem(x)[0],this.userData&&(this.uuserid=this.navParams.get("uuserid"),this.user=this.navParams.get("user"),this.type=this.navParams.get("type"),this.user_encryption_token=this.navParams.get("user_encryption_token"),this.checkLiveCall(this.type))}checkLiveCall(n){return(0,v.mG)(this,void 0,void 0,function*(){var s=Number(this.userData.userid+this.uuserid),l=C()(this.user_encryption_token+s),g=this.encryptionLi(l,"live_connet_token","encrypting");this.webRtcConnetLiveCall(n,g)})}webRtcConnetLiveCall(n,s){return(0,v.mG)(this,void 0,void 0,function*(){this.connectionLive=new(I()),this.connectionLive.enableLogs=!1,this.connectionLive.enableFileSharing=!1,this.connectionLive.socketURL=this.socketurl,this.connectionLive.session={data:!0,video:!1,audio:!1},this.connectionLive.autoSaveToDisk=!1,this.connectionLive.extra={userid:this.userData.userid,fullName:this.userData.name,email:this.userData.email,password:this.userData.password,logintype:this.userData.logintype,photo:"none",desc_status:this.userData.desc_status},this.connectionLive.onopen=i=>{i.extra.userid==this.uuserid&&(this.serverstatus="yesconnect")},this.connectionLive.onmute=i=>{console.log(i),i.mediaElement.srcObject=null,i.mediaElement.setAttribute("poster","photo.jpg")},this.connectionLive.onunmute=i=>{console.log(i),i.mediaElement.srcObject=i.stream,i.mediaElement.removeAttribute("poster")},this.connectionLive.onleave=i=>{this.serverstatus="noconnect";var r=document.getElementById("connectmediayou");document.getElementById("connectmediame"),r&&(r.innerHTML="")},this.connectionLive.onclose=i=>{this.serverstatus="noconnect";var r=document.getElementById("connectmediayou");document.getElementById("connectmediame"),r&&(r.innerHTML="")},this.connectionLive.onstreamended=i=>{var r=document.getElementById("connectmediayou"),u=document.getElementById("connectmediame");if("local"===i.type&&u&&(r.innerHTML=""),"remote"===i.type&&r&&(r.innerHTML=""),i.extra.userid==this.uuserid){this.serverstatus="noconnect";var _=document.getElementById("audioOfficsals");_&&(_.src="assets/sound/disconnect-sound.mp3",_.volume=.4,setTimeout(()=>{_.play()},5))}},this.connectionLive.onstream=i=>{i.extra.userid==this.uuserid&&(this.serverstatus="yesconnect"),this.streamid=i.streamid,this.streamuserid=i.userid;var r=document.getElementById("audioOfficsals");r&&(r.src="assets/sound/connect-sound.mp3",r.volume=.4,setTimeout(()=>{r.play()},5));var a,c,u=document.getElementById("connectmediayou"),_=document.getElementById("connectmediame");("local"===i.type&&(i.stream.isVideo&&((a=i.mediaElement).id="cvideo_-"+i.userid,a.className="video-connadds",a.controls=!1,a.muted=!0,a.poster=i.extra.avatar,a.style="width: 100%;height: 100%;background: black; object-fit: cover;",_.appendChild(a),_.style.display="flex"),i.stream.isAudio&&((c=i.mediaElement).id="caudio_-"+i.userid,c.className="audip-connadds",c.controls=!1,c.muted=!0,_.appendChild(c))),"remote"===i.type)&&(i.stream.isVideo&&((a=i.mediaElement).id="cvideo_-"+i.userid,a.className="video-connadds",a.controls=!1,a.muted=!1,a.poster=i.extra.avatar,a.style="width: 100%;height: 100%;background: black; object-fit: cover;",u.appendChild(a),u.style.display="flex"),i.stream.isAudio&&((c=i.mediaElement).id="caudio_-"+i.userid,c.className="audip-connadds",c.controls=!1,c.muted=!1,u.appendChild(c)))};var p=s;this.connectionLive.socketMessageEvent=p,this.connectionLive.openOrJoin(p,(i,r,u,_)=>{_&&(console.log(_),this.serverstatus="connecterror"),!0===i&&(this.serverstatus="noconnect",setTimeout(()=>{"voice"==n&&(this.connectionLive.mediaConstraints={audio:!0,video:!1},this.connectionLive.addStream({video:!1,audio:!0}),console.log("voice")),"video"==n&&(this.connectionLive.mediaConstraints={audio:!0,video:!0},this.connectionLive.addStream({video:!0,audio:!0}),console.log("video"))},500))})})}mute(){var n=this.connectionLive.streamEvents.selectFirst({local:!0}).stream;console.log(n),this.mic_isveled?(n.unmute(),console.log("unmute"),this.mic_isveled=!1):(n.mute(),console.log("mute"),this.mic_isveled=!0)}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){this.localStorageService.getItem(x)&&(yield this.dataConfig.getConf().then(s=>{this.socketurl=s.socketurl}),yield this.userdata())})}closeModal(){var n=document.getElementById("connectmediayou"),s=document.getElementById("connectmediame");n&&(n.innerHTML=""),s&&(s.innerHTML=""),this.connectionLive.attachStreams.forEach(g=>{g.stop()}),this.connectionLive.closeSocket();var l=document.getElementById("audioOfficsals");l&&(l.src="assets/sound/disconnect-sound.mp3",l.volume=.4,setTimeout(()=>{l.play()},5)),setTimeout(()=>{this.modalCtrl.dismiss()},150)}time(){var n=new Date,l=(n.getSeconds(),n.getMinutes());return("0"+n.getHours()).substr(-2)+":"+("0"+l).substr(-2)}encryptionLi(n,s,l){if("encrypting"==l)return((i,r)=>{const u=c=>c.split("").map(h=>h.charCodeAt(0));return r.split("").map(u).map(c=>u(i).reduce((h,se)=>h^se,c)).map(c=>("0"+Number(c).toString(16)).substr(-2)).join("")})(n,btoa(unescape(encodeURIComponent(s))));if("decrypting"==l){const i=((i,r)=>r.match(/.{1,2}/g).map(a=>parseInt(a,16)).map(a=>(a=>a.split("").map(c=>c.charCodeAt(0)))(i).reduce((c,h)=>c^h,a)).map(a=>String.fromCharCode(a)).join(""))(n,s);return decodeURIComponent(escape(window.atob(i)))}}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(m.IN),e.Y36(Z.n),e.Y36(m.X1),e.Y36(E.f),e.Y36(m.t4),e.Y36(P.V))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-call"]],decls:9,vars:6,consts:[["class","ion-no-border",4,"ngIf"],["id","connectmediayou","class","connectmediayou","style","display: none;",4,"ngIf"],["id","connectmediame","class","connectmediame","style","display: none;",4,"ngIf"],["style","\nposition: fixed;\nbackground: rgb(0 0 0 / 10%);\nbackdrop-filter: blur(1px);\n","class","ion-no-border",3,"translucent",4,"ngIf"],["id","connectmediayou","class","connectmediayou","style","display: block;",4,"ngIf"],["id","connectmediame","class","connectmediame","style","display: block;",4,"ngIf"],["id","audioOfficsals","controls","",2,"display","none"],["src","","type","audio/mpeg"],[1,"ion-no-border"],["slot","start"],["lines","none",4,"ngIf"],["slot","end",2,"padding-right","7px"],["class","yenimesajbtn","color","dark",3,"click",4,"ngIf"],["lines","none"],[3,"id","src",4,"ngIf"],["src","assets/images/avatars/0.jpg",3,"id",4,"ngIf"],[1,"ion-no-margin"],[3,"id"],["class","ion-no-margin",3,"id",4,"ngIf"],["class","ion-no-margin",4,"ngIf"],[3,"id","src"],["src","assets/images/avatars/0.jpg",3,"id"],[1,"ion-no-margin",3,"id"],["color","dark",1,"yenimesajbtn",3,"click"],["slot","icon-only","name","mic-outline",4,"ngIf"],["slot","icon-only","name","mic-off-outline",4,"ngIf"],["slot","icon-only","name","mic-outline"],["slot","icon-only","name","mic-off-outline"],["slot","icon-only","name","close-outline"],["id","connectmediayou",1,"connectmediayou",2,"display","none"],["id","connectmediame",1,"connectmediame",2,"display","none"],[1,"ion-no-border",2,"position","fixed","background","rgb(0 0 0 / 10%)","backdrop-filter","blur(1px)",3,"translucent"],[2,"background","transparent","--background","transparent"],["style","\nbackground: transparent;\n--background: transparent;\n","lines","none",4,"ngIf"],["lines","none",2,"background","transparent","--background","transparent"],[2,"color","white",3,"id"],["style","\ncolor: white;\n","class","ion-no-margin",3,"id",4,"ngIf"],["style","\ncolor: white;\n","class","ion-no-margin",4,"ngIf"],[1,"ion-no-margin",2,"color","white",3,"id"],[1,"ion-no-margin",2,"color","white"],["color","light","slot","icon-only","name","videocam-outline",4,"ngIf"],["color","light","slot","icon-only","name","videocam-off-outline",4,"ngIf"],["color","light","slot","icon-only","name","videocam-outline"],["color","light","slot","icon-only","name","videocam-off-outline"],["color","light","slot","icon-only","name","close-outline"],["id","connectmediayou",1,"connectmediayou",2,"display","block"],["id","connectmediame",1,"connectmediame",2,"display","block"]],template:function(n,s){1&n&&(e.YNc(0,B,7,3,"ion-header",0),e.YNc(1,j,1,0,"div",1),e.YNc(2,R,1,0,"div",2),e.YNc(3,ne,7,4,"ion-header",3),e.YNc(4,te,1,0,"div",4),e.YNc(5,ie,1,0,"div",5),e.TgZ(6,"audio",6),e._UZ(7,"source",7),e._uU(8,"\nYour browser does not support the audio element.\n"),e.qZA()),2&n&&(e.Q6J("ngIf","voice"==s.type),e.xp6(1),e.Q6J("ngIf","voice"==s.type),e.xp6(1),e.Q6J("ngIf","voice"==s.type),e.xp6(1),e.Q6J("ngIf","video"==s.type),e.xp6(1),e.Q6J("ngIf","video"==s.type),e.xp6(1),e.Q6J("ngIf","video"==s.type))},directives:[L.O5,m.Gu,m.sr,m.Sm,m.Ie,m.BJ,m.Q$,m.YG,m.gu],pipes:[A.X$],styles:[".connectmediame[_ngcontent-%COMP%]{position:fixed;width:100px;height:140px;z-index:999999;bottom:0;right:0;margin:20px;background:black;border-radius:5px;border:solid 1px rgba(54,54,54,.41)}.connectmediayou[_ngcontent-%COMP%]{width:100%;height:100%;background:black}"]}),t})()}}]);