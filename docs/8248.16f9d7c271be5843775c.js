(self.webpackChunkion_holla_messenger=self.webpackChunkion_holla_messenger||[]).push([[8248],{4452:(k,V,O)=>{"use strict";O.d(V,{T:()=>A});var P=O(8384),B=O(4553);class U extends P.Uw{write(X){var Z=this;return(0,B.Z)(function*(){if("undefined"==typeof navigator||!navigator.clipboard)throw Z.unavailable("Clipboard API not available in this browser");if(void 0!==X.string)yield Z.writeText(X.string);else if(X.url)yield Z.writeText(X.url);else{if(!X.image)throw new Error("Nothing to write");if("undefined"==typeof ClipboardItem)throw Z.unavailable("Writing images to the clipboard is not supported in this browser");try{const ae=yield(yield fetch(X.image)).blob(),re=new ClipboardItem({[ae.type]:ae});yield navigator.clipboard.write([re])}catch(ae){throw new Error("Failed to write image")}}})()}read(){var X=this;return(0,B.Z)(function*(){if("undefined"==typeof navigator||!navigator.clipboard)throw X.unavailable("Clipboard API not available in this browser");if("undefined"==typeof ClipboardItem)return X.readText();try{const Z=yield navigator.clipboard.read(),ae=Z[0].types[0],re=yield Z[0].getType(ae);return{value:yield X._getBlobData(re,ae),type:ae}}catch(Z){return X.readText()}})()}readText(){var X=this;return(0,B.Z)(function*(){if("undefined"==typeof navigator||!navigator.clipboard||!navigator.clipboard.readText)throw X.unavailable("Reading from clipboard not supported in this browser");return{value:yield navigator.clipboard.readText(),type:"text/plain"}})()}writeText(X){var Z=this;return(0,B.Z)(function*(){if("undefined"==typeof navigator||!navigator.clipboard||!navigator.clipboard.writeText)throw Z.unavailable("Writting to clipboard not supported in this browser");yield navigator.clipboard.writeText(X)})()}_getBlobData(X,Z){return new Promise((ae,re)=>{const Q=new FileReader;Z.includes("image")?Q.readAsDataURL(X):Q.readAsText(X),Q.onloadend=()=>{ae(Q.result)},Q.onerror=we=>{re(we)}})}}const A=(0,P.fo)("Clipboard",{web:()=>new U})},887:(k,V,O)=>{"use strict";O.d(V,{f:()=>re});var P=O(4762);const U=(0,O(8384).fo)("App",{web:()=>O.e(6141).then(O.bind(O,6141)).then(Q=>new Q.AppWeb)});var A=O(4452),q=O(3018),X=O(4490),Z=O(4540),ae=O(8583);let re=(()=>{class Q{constructor(ee,se,ie,pe,Se,te){this.toastController=ee,this.alertController=se,this.translate=ie,this.navCtrl=pe,this.modalController=Se,this.location=te}createWindow(ee){return(0,P.mG)(this,void 0,void 0,function*(){window.open(ee,"_blank","nodeIntegration=no")})}EC_exitApp(){return(0,P.mG)(this,void 0,void 0,function*(){U.exitApp()})}ToastShowModal(ee,se,ie){return(0,P.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:ee,duration:se,position:ie})).present()})}presentAlert(ee,se,ie,pe,Se){return(0,P.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:se,header:ie,subHeader:pe,message:ee,buttons:[Se]})).present()})}copyText(ee,se,ie){return(0,P.mG)(this,void 0,void 0,function*(){A.T.write({string:ee}),this.ToastShowModal(se+" "+ie,"1000","bottom")})}xtranslate(ee){return this.translate.get(ee).subscribe(se=>{this.nval=se}),this.nval}uumakeid(ee){for(var se="",ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",pe=ie.length,Se=0;Se<ee;Se++)se+=ie.charAt(Math.floor(Math.random()*pe));return se}navCtrlNF(ee){return this.navCtrl.navigateForward(ee)}navCtrlNB(ee){return this.navCtrl.navigateBack(ee)}navCtrlNR(ee){return this.navCtrl.navigateRoot(ee)}navCtrlBack(){return this.navCtrl.back()}goBack(){return this.location.back()}}return Q.\u0275fac=function(ee){return new(ee||Q)(q.LFG(X.yF),q.LFG(X.Br),q.LFG(Z.sK),q.LFG(X.SH),q.LFG(X.IN),q.LFG(ae.Ye))},Q.\u0275prov=q.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q})()},393:(k,V,O)=>{"use strict";O.d(V,{V:()=>X});var P=O(4762),B=O(5917),U=O(3342),A=O(3018),q=O(1841);let X=(()=>{class Z{constructor(re){this.http=re}load(){return this.data?(0,B.of)(this.data).toPromise():this.http.get("assets/data/config.json").pipe((0,U.b)(re=>this.data=re)).toPromise()}getConf(){return(0,P.mG)(this,void 0,void 0,function*(){return this.load().then(re=>re.alllist[0].get)})}}return Z.\u0275fac=function(re){return new(re||Z)(A.LFG(q.eN))},Z.\u0275prov=A.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z})()},4353:(k,V)=>{"use strict";var P,B=function(U,A){function q(d,R){function x(g){return!g.audio&&!g.video&&!g.screen&&g.data}function b(g,D){d.peersBackup[g]||(d.peersBackup[g]={userid:g,extra:{}}),d.peersBackup[g].extra=D}var C="";C+="?userid="+d.userid,C+="&sessionid="+d.sessionid,C+="&msgEvent="+d.socketMessageEvent,C+="&socketCustomEvent="+d.socketCustomEvent,C+="&autoCloseEntireSession="+!!d.autoCloseEntireSession,!0===d.session.broadcast&&(C+="&oneToMany=true"),C+="&maxParticipantsAllowed="+d.maxParticipantsAllowed,d.enableScalableBroadcast&&(C+="&enableScalableBroadcast=true",C+="&maxRelayLimitPerUser="+(d.maxRelayLimitPerUser||2)),C+="&extra="+JSON.stringify(d.extra||{}),d.socketCustomParameters&&(C+=d.socketCustomParameters);try{io.sockets={}}catch(g){}if(d.socketURL||(d.socketURL="/"),"/"!=d.socketURL.substr(d.socketURL.length-1,1))throw'"socketURL" MUST end with a slash.';d.enableLogs&&("/"==d.socketURL?console.info("socket.io url is: ",location.origin+"/"):console.info("socket.io url is: ",d.socketURL));try{d.socket=io(d.socketURL+C)}catch(g){d.socket=io.connect(d.socketURL+C,d.socketOptions)}var S=d.multiPeersHandler;d.socket.on("extra-data-updated",function(g,D){d.peers[g]&&(d.peers[g].extra=D,d.onExtraDataUpdated({userid:g,extra:D}),b(g,D))}),d.socket.on(d.socketMessageEvent,function E(g){if(g.remoteUserId==d.userid){if(d.peers[g.sender]&&d.peers[g.sender].extra!=g.message.extra&&(d.peers[g.sender].extra=g.extra,d.onExtraDataUpdated({userid:g.sender,extra:g.extra}),b(g.sender,g.extra)),g.message.streamSyncNeeded&&d.peers[g.sender]){var D=d.streamEvents[g.message.streamid];if(!D||!D.stream)return;var F=g.message.action;return"ended"===F||"inactive"===F||"stream-removed"===F?(d.peersBackup[D.userid]&&(D.extra=d.peersBackup[D.userid].extra),void d.onstreamended(D)):void("function"==typeof D.stream[F]&&D.stream[F]("both"!=g.message.type?g.message.type:null))}if("dropPeerConnection"===g.message)return void d.deletePeer(g.sender);if(g.message.allParticipants)return-1===g.message.allParticipants.indexOf(g.sender)&&g.message.allParticipants.push(g.sender),void g.message.allParticipants.forEach(function(l){S[d.peers[l]?"renegotiatePeer":"createNewPeer"](l,{localPeerSdpConstraints:{OfferToReceiveAudio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:d.session.oneway?!!d.session.audio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.session.oneway?!!d.session.video||!!d.session.screen:d.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!d.session.oneway||"one-way"===d.direction,isDataOnly:x(d.session)})});if(g.message.newParticipant)return g.message.newParticipant==d.userid||d.peers[g.message.newParticipant]?void 0:void S.createNewPeer(g.message.newParticipant,g.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:d.session.oneway?!!d.session.audio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.session.oneway?!!d.session.video||!!d.session.screen:d.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!d.session.oneway||"one-way"===d.direction,isDataOnly:x(d.session)});if(g.message.readyForOffer&&(d.attachStreams.length&&(d.waitingForLocalMedia=!1),d.waitingForLocalMedia))return void setTimeout(function(){E(g)},1);if(g.message.newParticipationRequest&&g.sender!==d.userid){d.peers[g.sender]&&d.deletePeer(g.sender);var Y={extra:g.extra||{},localPeerSdpConstraints:g.message.remotePeerSdpConstraints||{OfferToReceiveAudio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:g.message.localPeerSdpConstraints||{OfferToReceiveAudio:d.session.oneway?!!d.session.audio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.session.oneway?!!d.session.video||!!d.session.screen:d.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:void 0!==g.message.isOneWay?g.message.isOneWay:!!d.session.oneway||"one-way"===d.direction,isDataOnly:void 0!==g.message.isDataOnly?g.message.isDataOnly:x(d.session),dontGetRemoteStream:void 0!==g.message.isOneWay?g.message.isOneWay:!!d.session.oneway||"one-way"===d.direction,dontAttachLocalStream:!!g.message.dontGetRemoteStream,connectionDescription:g,successCallback:function(){}};return void d.onNewParticipant(g.sender,Y)}return g.message.changedUUID&&d.peers[g.message.oldUUID]&&(d.peers[g.message.newUUID]=d.peers[g.message.oldUUID],delete d.peers[g.message.oldUUID]),g.message.userLeft?(S.onUserLeft(g.sender),void(g.message.autoCloseEntireSession&&d.leave())):void S.addNegotiatedMessage(g.message,g.sender)}});var L=!1;d.socket.resetProps=function(){L=!1},d.socket.on("connect",function(){L||(L=!0,d.enableLogs&&console.info("socket.io connection is opened."),setTimeout(function(){d.socket.emit("extra-data-updated",d.extra)},1e3),R&&R(d.socket))}),d.socket.on("disconnect",function(g){d.onSocketDisconnect(g)}),d.socket.on("error",function(g){d.onSocketError(g)}),d.socket.on("user-disconnected",function(g){g!==d.userid&&(d.onUserStatusChanged({userid:g,status:"offline",extra:d.peers[g]&&d.peers[g].extra||{}}),d.deletePeer(g))}),d.socket.on("user-connected",function(g){g!==d.userid&&d.onUserStatusChanged({userid:g,status:"online",extra:d.peers[g]&&d.peers[g].extra||{}})}),d.socket.on("closed-entire-session",function(g,D){d.leave(),d.onEntireSessionClosed({sessionid:g,userid:g,extra:D})}),d.socket.on("userid-already-taken",function(g,D){d.onUserIdAlreadyTaken(g,D)}),d.socket.on("logs",function(g){d.enableLogs&&console.debug("server-logs",g)}),d.socket.on("number-of-broadcast-viewers-updated",function(g){d.onNumberOfBroadcastViewersUpdated(g)}),d.socket.on("set-isInitiator-true",function(g){g==d.sessionid&&(d.isInitiator=!0)})}function X(d){function R(){d.fbr=new FileBufferReader,d.fbr.onProgress=function(C){d.onFileProgress(C)},d.fbr.onBegin=function(C){d.onFileStart(C)},d.fbr.onEnd=function(C){d.onFileEnd(C)}}var x=this,b=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];d.peers={getLength:function(){var C=0;for(var S in this)-1==b.indexOf(S)&&C++;return C},selectFirst:function(){var C;for(var S in this)-1==b.indexOf(S)&&(C=this[S]);return C},getAllParticipants:function(C){var S=[];for(var L in this)-1==b.indexOf(L)&&L!=C&&S.push(L);return S},forEach:function(C){this.getAllParticipants().forEach(function(S){C(d.peers[S])})},send:function(C,S){var L=this;if(!pe(C.size)&&!pe(C.type)){if(d.enableFileSharing)return void x.shareFile(C,S);"string"!=typeof C&&(C=JSON.stringify(C))}if("text"===C.type||C instanceof ArrayBuffer||C instanceof DataView){if("text"===C.type&&(C=JSON.stringify(C)),S){var g=d.peers[S];if(g)return g.channels.length?void g.channels.forEach(function(D){D.send(C)}):(d.peers[S].createDataChannel(),d.renegotiate(S),void setTimeout(function(){L.send(C,S)},3e3))}this.getAllParticipants().forEach(function(D){return L[D].channels.length?void L[D].channels.forEach(function(F){F.send(C)}):(d.peers[D].createDataChannel(),d.renegotiate(D),void setTimeout(function(){L[D].channels.forEach(function(F){F.send(C)})},3e3))})}else ht.send({text:C,channel:this,connection:d,remoteUserId:S})}},this.uuid=d.userid,this.getLocalConfig=function(C,S,L){return L||(L={}),{streamsToShare:L.streamsToShare||{},rtcMultiConnection:d,connectionDescription:L.connectionDescription,userid:S,localPeerSdpConstraints:L.localPeerSdpConstraints,remotePeerSdpConstraints:L.remotePeerSdpConstraints,dontGetRemoteStream:!!L.dontGetRemoteStream,dontAttachLocalStream:!!L.dontAttachLocalStream,renegotiatingPeer:!!L.renegotiatingPeer,peerRef:L.peerRef,channels:L.channels||[],onLocalSdp:function(g){x.onNegotiationNeeded(g,S)},onLocalCandidate:function(g){(g=pt.processCandidates(d,g))&&x.onNegotiationNeeded(g,S)},remoteSdp:C,onDataChannelMessage:function(g){if(!d.fbr&&d.enableFileSharing&&R(),"string"!=typeof g&&d.enableFileSharing){var D=this;return g instanceof ArrayBuffer||g instanceof DataView?void d.fbr.convertToObject(g,function(F){D.onDataChannelMessage(F)}):g.readyForNextChunk?void d.fbr.getNextChunk(g,function(F,J){d.peers[S].channels.forEach(function(Y){Y.send(F)})},S):g.chunkMissing?void d.fbr.chunkMissing(g):void d.fbr.addChunk(g,function(F){d.peers[S].peer.channel.send(F)})}x.onDataChannelMessage(g,S)},onDataChannelError:function(g){x.onDataChannelError(g,S)},onDataChannelOpened:function(g){x.onDataChannelOpened(g,S)},onDataChannelClosed:function(g){x.onDataChannelClosed(g,S)},onRemoteStream:function(g){d.peers[S]&&d.peers[S].streams.push(g),x.onGettingRemoteMedia(g,S)},onRemoteStreamRemoved:function(g){x.onRemovingRemoteMedia(g,S)},onPeerStateChanged:function(g){x.onPeerStateChanged(g),"new"===g.iceConnectionState&&x.onNegotiationStarted(S,g),"connected"===g.iceConnectionState&&x.onNegotiationCompleted(S,g),-1!==g.iceConnectionState.search(/closed|failed/gi)&&(x.onUserLeft(S),x.disconnectWith(S))}}},this.createNewPeer=function(C,S){if(!(d.maxParticipantsAllowed<=d.getAllParticipants().length)){if(S=S||{},d.isInitiator&&d.session.audio&&"two-way"===d.session.audio&&!S.streamsToShare&&(S.isOneWay=!1,S.isDataOnly=!1,S.session=d.session),!S.isOneWay&&!S.isDataOnly)return S.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:S},C);S=d.setUserPreferences(S,C);var L=this.getLocalConfig(null,C,S);d.peers[C]=new Ie(L)}},this.createAnsweringPeer=function(C,S,L){L=d.setUserPreferences(L||{},S);var g=this.getLocalConfig(C,S,L);d.peers[S]=new Ie(g)},this.renegotiatePeer=function(C,S,L){if(d.peers[C]){S||(S={}),S.renegotiatingPeer=!0,S.peerRef=d.peers[C].peer,S.channels=d.peers[C].channels;var g=this.getLocalConfig(L,C,S);d.peers[C]=new Ie(g)}else d.enableLogs&&console.error("Peer ("+C+") does not exist. Renegotiation skipped.")},this.replaceTrack=function(C,S,L){if(!d.peers[S])throw"This peer ("+S+") does not exist.";var g=d.peers[S].peer;return g.getSenders&&"function"==typeof g.getSenders&&g.getSenders().length?void g.getSenders().forEach(function(D){L&&"video"===D.track.kind&&(d.peers[S].peer.lastVideoTrack=D.track,D.replaceTrack(C)),L||"audio"!==D.track.kind||(d.peers[S].peer.lastAudioTrack=D.track,D.replaceTrack(C))}):(console.warn("RTPSender.replaceTrack is NOT supported."),void this.renegotiatePeer(S))},this.onNegotiationNeeded=function(C,S){},this.addNegotiatedMessage=function(C,S){if(C.type&&C.sdp)return"answer"==C.type&&d.peers[S]&&d.peers[S].addRemoteSdp(C),"offer"==C.type&&(C.renegotiatingPeer?this.renegotiatePeer(S,null,C):this.createAnsweringPeer(C,S)),void(d.enableLogs&&console.log("Remote peer's sdp:",C.sdp));if(C.candidate)return d.peers[S]&&d.peers[S].addRemoteCandidate(C),void(d.enableLogs&&console.log("Remote peer's candidate pairs:",C.candidate));if(C.enableMedia){d.session=C.userPreferences.session||d.session,d.session.oneway&&d.attachStreams.length&&(d.attachStreams=[]),C.userPreferences.isDataOnly&&d.attachStreams.length&&(d.attachStreams.length=[]);var L={};d.attachStreams.forEach(function(g){L[g.streamid]={isAudio:!!g.isAudio,isVideo:!!g.isVideo,isScreen:!!g.isScreen}}),C.userPreferences.streamsToShare=L,x.onNegotiationNeeded({readyForOffer:!0,userPreferences:C.userPreferences},S)}C.readyForOffer&&d.onReadyForOffer(S,C.userPreferences)},this.onGettingRemoteMedia=function(C,S){},this.onRemovingRemoteMedia=function(C,S){},this.onGettingLocalMedia=function(C){},this.onLocalMediaError=function(C,S){d.onMediaError(C,S)},this.shareFile=function(C,S){R(),d.fbr.readAsArrayBuffer(C,function(L){var g=d.getAllParticipants();S&&(g=[S]),g.forEach(function(D){d.fbr.getNextChunk(L,function(F){d.peers[D].channels.forEach(function(J){J.send(F)})},D)})},{userid:d.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15e3:d.chunkSize||0})};var E=new ft(d);this.onDataChannelMessage=function(C,S){E.receive(JSON.parse(C),S,d.peers[S]?d.peers[S].extra:{})},this.onDataChannelClosed=function(C,S){C.userid=S,C.extra=d.peers[S]?d.peers[S].extra:{},d.onclose(C)},this.onDataChannelError=function(C,S){C.userid=S,event.extra=d.peers[S]?d.peers[S].extra:{},d.onerror(C)},this.onDataChannelOpened=function(C,S){return d.peers[S].channels.length?void(d.peers[S].channels=[C]):(d.peers[S].channels.push(C),void d.onopen({userid:S,extra:d.peers[S]?d.peers[S].extra:{},channel:C}))},this.onPeerStateChanged=function(C){d.onPeerStateChanged(C)},this.onNegotiationStarted=function(C,S){},this.onNegotiationCompleted=function(C,S){},this.getRemoteStreams=function(C){return C=C||d.peers.getAllParticipants()[0],d.peers[C]?d.peers[C].streams:[]}}function Z(d,R,x){if("undefined"!=typeof CustomEvent){var E=new CustomEvent(R,{arguments:x,__exposedProps__:x});d.dispatchEvent(E)}}function re(d,R){R.stream&&R.stream&&R.stream.addEventListener&&(R.stream.addEventListener("mute",function(x){(x=d.streamEvents[R.streamid]).session={audio:"audio"===x.muteType,video:"video"===x.muteType},d.onmute(x)},!1),R.stream.addEventListener("unmute",function(x){(x=d.streamEvents[R.streamid]).session={audio:"audio"===x.unmuteType,video:"video"===x.unmuteType},d.onunmute(x)},!1))}function Q(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var d=window.crypto.getRandomValues(new Uint32Array(3)),R="",x=0,b=d.length;x<b;x++)R+=d[x].toString(36);return R}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function we(d,R,x){if(x.autoCreateMediaElement){var b=!1;de(d,"video").length||d.isVideo||d.isScreen||(b=!0),"Firefox"===DetectRTC.browser.name&&(x.session.video||x.session.screen)&&(b=!1);var E=document.createElement(b?"audio":"video");if(E.srcObject=d,E.setAttribute("autoplay",!0),E.setAttribute("playsinline",!0),E.setAttribute("controls",!0),E.setAttribute("muted",!1),E.setAttribute("volume",1),"Firefox"===DetectRTC.browser.name){var C="ended";"oninactive"in E&&(C="inactive"),E.addEventListener(C,function(){if(currentUserMediaRequest.remove(d.idInstance),"local"===d.type){C="ended","oninactive"in d&&(C="inactive"),le.onSyncNeeded(d.streamid,C),x.attachStreams.forEach(function(F,J){d.streamid===F.streamid&&delete x.attachStreams[J]});var g=[];x.attachStreams.forEach(function(F){F&&g.push(F)}),x.attachStreams=g;var D=x.streamEvents[d.streamid];if(D)return void x.onstreamended(D);this.parentNode&&this.parentNode.removeChild(this)}},!1)}var S=E.play();if(void 0!==S){var L=!1;setTimeout(function(){L||(L=!0,R(E))},1e3),S.then(function(){L||(L=!0,R(E))}).catch(function(g){L||(L=!0,R(E))})}else R(E)}else R({})}function ee(d,R){window.removeEventListener(d,R),window.addEventListener(d,R,!1)}function se(d){var R=[];return d.forEach(function(x){x&&R.push(x)}),R}function ie(d){return!d.audio&&!d.video&&!d.screen&&d.data}function pe(d){return void 0===d}function te(d,R){return!(d.session.audio&&"two-way"===d.session.audio||("Firefox"!==DetectRTC.browser.name||!1===R)&&("Chrome"!==DetectRTC.browser.name||DetectRTC.browser.version<50||!0!==typeof R&&(void 0!==R||!d.session.audio||!d.session.screen||d.session.video||(R=!0,0))))}function de(d,R){return d&&d.getTracks?d.getTracks().filter(function(x){return x.kind===(R||"audio")}):[]}function Ke(){if("undefined"!=typeof cordova&&void 0!==cordova.plugins&&void 0!==cordova.plugins.iosrtc){var d=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=d.RTCPeerConnection,window.RTCSessionDescription=d.RTCSessionDescription,window.RTCIceCandidate=d.RTCIceCandidate,window.MediaStream=d.MediaStream,window.MediaStreamTrack=d.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=d.getUserMedia,d.debug.enable("iosrtc*"),"function"==typeof d.selectAudioOutput&&d.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),d.registerGlobals()}}function Ne(d){return{OfferToReceiveAudio:!!d.OfferToReceiveAudio,OfferToReceiveVideo:!!d.OfferToReceiveVideo}}function Ie(d){function R(v){v.binaryType="arraybuffer",v.onmessage=function(w){d.onDataChannelMessage(w.data)},v.onopen=function(){d.onDataChannelOpened(v)},v.onerror=function(w){d.onDataChannelError(w)},v.onclose=function(w){d.onDataChannelClosed(w)},v.internalSend=v.send,v.send=function(w){"open"===v.readyState&&v.internalSend(w)},S.channel=v}function x(v){S[v](ke.sdpConstraints).then(function(w){"Safari"!==DetectRTC.browser.name&&(w.sdp=b.processSdp(w.sdp)),S.setLocalDescription(w).then(function(){b.trickleIce&&(d.onLocalSdp({type:w.type,sdp:w.sdp,remotePeerSdpConstraints:d.remotePeerSdpConstraints||!1,renegotiatingPeer:!!d.renegotiatingPeer||!1,connectionDescription:E.connectionDescription,dontGetRemoteStream:!!d.dontGetRemoteStream,extra:b?b.extra:{},streamsToShare:m}),b.onSettingLocalDescription(E))},function(T){b.enableLogs&&console.error("setLocalDescription error",T)})},function(w){b.enableLogs&&console.error("sdp-error",w)})}if(void 0!==window.RTCPeerConnection?ue=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?ue=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(ue=webkitRTCPeerConnection),Je=window.RTCSessionDescription||window.mozRTCSessionDescription,Xe=window.RTCIceCandidate||window.mozRTCIceCandidate,he=window.MediaStreamTrack,!ue)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var b=d.rtcMultiConnection;this.extra=d.remoteSdp?d.remoteSdp.extra:b.extra,this.userid=d.userid,this.streams=[],this.channels=d.channels||[],this.connectionDescription=d.connectionDescription,this.addStream=function(v){b.addStream(v,E.userid)},this.removeStream=function(v){b.removeStream(v,E.userid)};var E=this;d.remoteSdp&&(this.connectionDescription=d.remoteSdp.connectionDescription);var C={};ke.sdpConstraints=Ne({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var S,L=!!d.renegotiatingPeer;d.remoteSdp&&(L=!!d.remoteSdp.renegotiatingPeer);var g=[];if(b.attachStreams.forEach(function(v){v&&g.push(v)}),L)S=d.peerRef;else{var D="all";(b.candidates.turn||b.candidates.relay)&&(b.candidates.stun||b.candidates.reflexive||b.candidates.host||(D="relay"));try{var F={iceServers:b.iceServers,iceTransportPolicy:b.iceTransportPolicy||D};void 0!==b.iceCandidatePoolSize&&(F.iceCandidatePoolSize=b.iceCandidatePoolSize),void 0!==b.bundlePolicy&&(F.bundlePolicy=b.bundlePolicy),void 0!==b.rtcpMuxPolicy&&(F.rtcpMuxPolicy=b.rtcpMuxPolicy),b.sdpSemantics&&(F.sdpSemantics=b.sdpSemantics||"unified-plan"),b.iceServers&&b.iceServers.length||(F=null,b.optionalArgument=null),S=new ue(F,b.optionalArgument)}catch(v){try{S=new ue(F={iceServers:b.iceServers})}catch(w){S=new ue}}}!S.getRemoteStreams&&S.getReceivers&&(S.getRemoteStreams=function(){var v=new Ce;return S.getReceivers().forEach(function(w){v.addTrack(w.track)}),[v]}),!S.getLocalStreams&&S.getSenders&&(S.getLocalStreams=function(){var v=new Ce;return S.getSenders().forEach(function(w){v.addTrack(w.track)}),[v]}),S.onicecandidate=function(v){if(v.candidate)b.trickleIce&&d.onLocalCandidate({candidate:v.candidate.candidate,sdpMid:v.candidate.sdpMid,sdpMLineIndex:v.candidate.sdpMLineIndex});else if(!b.trickleIce){var w=S.localDescription;d.onLocalSdp({type:w.type,sdp:w.sdp,remotePeerSdpConstraints:d.remotePeerSdpConstraints||!1,renegotiatingPeer:!!d.renegotiatingPeer||!1,connectionDescription:E.connectionDescription,dontGetRemoteStream:!!d.dontGetRemoteStream,extra:b?b.extra:{},streamsToShare:m})}},g.forEach(function(v){d.remoteSdp&&d.remoteSdp.remotePeerSdpConstraints&&d.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||d.dontAttachLocalStream||(v=b.beforeAddingStream(v,E))&&(S.getLocalStreams().forEach(function(w){v&&w.id==v.id&&(v=null)}),v&&v.getTracks&&v.getTracks().forEach(function(w){try{S.addTrack(w,v)}catch(T){}}))}),S.oniceconnectionstatechange=S.onsignalingstatechange=function(){var v=E.extra;b.peers[E.userid]&&(v=b.peers[E.userid].extra||v),S&&(d.onPeerStateChanged({iceConnectionState:S.iceConnectionState,iceGatheringState:S.iceGatheringState,signalingState:S.signalingState,extra:v,userid:E.userid}),S&&S.iceConnectionState&&-1!==S.iceConnectionState.search(/closed|failed/gi)&&E.streams instanceof Array&&E.streams.forEach(function(w){b.onstreamended(b.streamEvents[w.id]||{streamid:w.id,stream:w,type:"remote"})}))};var J={OfferToReceiveAudio:!!g.length,OfferToReceiveVideo:!!g.length};d.localPeerSdpConstraints&&(J=d.localPeerSdpConstraints),ke.sdpConstraints=Ne(J);var Y={};S.ontrack=function(v){if(v&&"track"===v.type){if(v.stream=v.streams[v.streams.length-1],v.stream.id||(v.stream.id=v.track.id),Y[v.stream.id]&&"Safari"!==DetectRTC.browser.name)return void(v.track&&(v.track.onended=function(){S&&S.onremovestream(v)}));Y[v.stream.id]=v.stream.id;var w={};d.remoteSdp&&d.remoteSdp.streamsToShare?w=d.remoteSdp.streamsToShare:d.streamsToShare&&(w=d.streamsToShare);var T=w[v.stream.id];T?(v.stream.isAudio=T.isAudio,v.stream.isVideo=T.isVideo,v.stream.isScreen=T.isScreen):(v.stream.isVideo=!!de(v.stream,"video").length,v.stream.isAudio=!v.stream.isVideo,v.stream.isScreen=!1),v.stream.streamid=v.stream.id,C[v.stream.id]=v.stream,d.onRemoteStream(v.stream),v.stream.getTracks().forEach(function(G){G.onended=function(){S&&S.onremovestream(v)}}),v.stream.onremovetrack=function(){S&&S.onremovestream(v)}}},S.onremovestream=function(v){v.stream.streamid=v.stream.id,C[v.stream.id]&&delete C[v.stream.id],d.onRemoteStreamRemoved(v.stream)},"function"!=typeof S.removeStream&&(S.removeStream=function(v){v.getTracks().forEach(function(w){S.removeTrack(w,v)})}),this.addRemoteCandidate=function(v){S.addIceCandidate(new Xe(v))},this.addRemoteSdp=function(v,w){w=w||function(){},"Safari"!==DetectRTC.browser.name&&(v.sdp=b.processSdp(v.sdp)),S.setRemoteDescription(new Je(v)).then(w,function(T){b.enableLogs&&console.error("setRemoteDescription failed","\n",T,"\n",v.sdp),w()}).catch(function(T){b.enableLogs&&console.error("setRemoteDescription failed","\n",T,"\n",v.sdp),w()})};var l=!0;d.remoteSdp&&(l=!1),this.createDataChannel=function(){R(S.createDataChannel("sctp",{}))},!0!==b.session.data||L||(l?this.createDataChannel():S.ondatachannel=function(v){R(v.channel)}),this.enableDisableVideoEncoding=function(v){var w;if(S.getSenders().forEach(function(G){w||"video"!==G.track.kind||(w=G)}),w&&w.getParameters){var T=w.getParameters();T.encodings[1]&&(T.encodings[1].active=!!v),T.encodings[2]&&(T.encodings[2].active=!!v),w.setParameters(T)}},d.remoteSdp&&(d.remoteSdp.remotePeerSdpConstraints&&(J=d.remoteSdp.remotePeerSdpConstraints),ke.sdpConstraints=Ne(J),this.addRemoteSdp(d.remoteSdp,function(){x("createAnswer")})),"two-way"!=b.session.audio&&"two-way"!=b.session.video&&"two-way"!=b.session.screen||(ke.sdpConstraints=Ne({OfferToReceiveAudio:"two-way"==b.session.audio||d.remoteSdp&&d.remoteSdp.remotePeerSdpConstraints&&d.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==b.session.video||"two-way"==b.session.screen||d.remoteSdp&&d.remoteSdp.remotePeerSdpConstraints&&d.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var m={};S.getLocalStreams().forEach(function(v){m[v.streamid]={isAudio:!!v.isAudio,isVideo:!!v.isVideo,isScreen:!!v.isScreen}}),l&&x("createOffer"),S.nativeClose=S.close,S.close=function(){if(S){try{S.nativeClose!==S.close&&S.nativeClose()}catch(v){}S=null,E.peer=null}},this.peer=S}function _e(d){function R(g,D){!function(d,R){d.mandatory&&d.mandatory.chromeMediaSource||d.mozMediaSource||d.mediaSource?R.isScreen=!0:d.video?R.isVideo=!0:d.audio&&(R.isAudio=!0)}(d.localMediaConstraints,g);var F="ended";"oninactive"in g&&(F="inactive"),g.addEventListener(F,function(){delete currentUserMediaRequest.streams[x],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(d)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(d)],currentUserMediaRequest.queueRequests=se(currentUserMediaRequest.queueRequests))},!1),currentUserMediaRequest.streams[x]={stream:g},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&_e(currentUserMediaRequest.queueRequests.shift()),d.onGettingLocalMedia(g,D)}if(!0!==currentUserMediaRequest.mutex){currentUserMediaRequest.mutex=!0;var x=JSON.stringify(d.localMediaConstraints);if(currentUserMediaRequest.streams[x])R(currentUserMediaRequest.streams[x].stream,!0);else{if(/BB10|BlackBerry/i.test(navigator.userAgent||"")||void 0===navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(d.localMediaConstraints,function(g){g.streamid=g.streamid||g.id||Q(),g.idInstance=x,R(g)},function(g){d.onLocalMediaError(g,d.localMediaConstraints)});if(void 0===navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var E,C,L=function(){};navigator.mediaDevices={getUserMedia:function(g){return navigator.getUserMedia(g,function(D){D(stream),E=stream},function(D){L(D),C=D}),{then:function(D){return E?void D(E):{then:function(F){return C?void F(C):void(L=F)}}}}}}}if(!0===d.localMediaConstraints.isScreen){if(navigator.mediaDevices.getDisplayMedia)navigator.mediaDevices.getDisplayMedia(d.localMediaConstraints).then(function(g){g.streamid=g.streamid||g.id||Q(),g.idInstance=x,R(g)}).catch(function(g){d.onLocalMediaError(g,d.localMediaConstraints)});else{if(!navigator.getDisplayMedia)throw new Error("getDisplayMedia API is not availabe in this browser.");navigator.getDisplayMedia(d.localMediaConstraints).then(function(g){g.streamid=g.streamid||g.id||Q(),g.idInstance=x,R(g)}).catch(function(g){d.onLocalMediaError(g,d.localMediaConstraints)})}return}navigator.mediaDevices.getUserMedia(d.localMediaConstraints).then(function(g){g.streamid=g.streamid||g.id||Q(),g.idInstance=x,R(g)}).catch(function(g){d.onLocalMediaError(g,d.localMediaConstraints)})}}else currentUserMediaRequest.queueRequests.push(d)}function ft(d){var x={};return{receive:function(b,E,C){var S=b.uuid;if(x[S]||(x[S]=[]),x[S].push(b.message),b.last){var L=x[S].join("");b.isobject&&(L=JSON.parse(L));var F={data:L,userid:E,extra:C,latency:(new Date).getTime()-b.sendingTime};d.autoTranslateText?(F.original=F.data,d.Translator.TranslateText(F.data,function(J){F.data=J,d.onmessage(F)})):d.onmessage(F),delete x[S]}}}}var d;(d="undefined"!=typeof global?global:null)&&"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},global.console||(global.console={}),void 0===global.console.debug&&(global.console.debug=global.console.info=global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(d.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var R={getContext:function(){return R},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return R},document.addEventListener=document.removeEventListener=d.addEventListener=d.removeEventListener=function(){},d.HTMLVideoElement=d.HTMLMediaElement=function(){}),"undefined"==typeof io&&(d.io=function(){return{on:function(R,x){x=x||function(){},"connect"===R&&x()},emit:function(R,x,b){b=b||function(){},"open-room"!==R&&"join-room"!==R||b(!0,x.sessionid,null)}}}),"undefined"==typeof location&&(d.location={protocol:"file:",href:"",hash:"",origin:"self"}),"undefined"==typeof screen&&(d.screen={width:0,height:0}),"undefined"==typeof URL&&(d.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),d.window=global),function(){function R(W,I){var j=0,N=!1,H=window.setInterval(function(){W()&&(window.clearInterval(H),I(N)),j++>50&&(window.clearInterval(H),I(N=!0))},10)}var W,F="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if("object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser){var Y=process.versions.node.toString().replace("v","");F="Nodejs/"+Y+" (NodeOS) AppleWebKit/"+Y+" (KHTML, like Gecko) Nodejs/"+Y+" Nodejs/"+Y}W="undefined"!=typeof global?global:window,"undefined"==typeof window&&("undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:F,getUserMedia:function(){}},W.window=global),"undefined"==typeof location&&(W.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(W.screen={width:0,height:0}));var l=window.navigator;void 0!==l?(void 0!==l.webkitGetUserMedia&&(l.getUserMedia=l.webkitGetUserMedia),void 0!==l.mozGetUserMedia&&(l.getUserMedia=l.mozGetUserMedia)):l={getUserMedia:function(){},userAgent:F};var m=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(l.userAgent||""),v=!(-1===l.userAgent.indexOf("Edge")||!l.msSaveOrOpenBlob&&!l.msSaveBlob),w=!!window.opera||l.userAgent.indexOf(" OPR/")>=0,T=void 0!==window.InstallTrigger,G=/^((?!chrome|android).)*safari/i.test(l.userAgent),z=!!window.chrome&&!w,K="undefined"!=typeof document&&!!document.documentMode&&!v,$={Android:function(){return l.userAgent.match(/Android/i)},BlackBerry:function(){return l.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return l.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return l.userAgent.match(/Opera Mini/i)},Windows:function(){return l.userAgent.match(/IEMobile/i)},any:function(){return $.Android()||$.BlackBerry()||$.iOS()||$.Opera()||$.Windows()},getOsName:function(){var W="Unknown OS";return $.Android()&&(W="Android"),$.BlackBerry()&&(W="BlackBerry"),$.iOS()&&(W="iOS"),$.Opera()&&(W="Opera Mini"),$.Windows()&&(W="Windows"),W}},ge="Unknown OS",ye="Unknown OS Version",ce=function(){for(var W,j=l.appVersion,_=l.userAgent,N="-",H=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],fe=0;W=H[fe];fe++)if(W.r.test(_)){N=W.s;break}var oe="-";switch(/Windows/.test(N)&&(/Windows (.*)/.test(N)&&(oe=/Windows (.*)/.exec(N)[1]),N="Windows"),N){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(_)&&(oe=/Mac OS X (10[\.\_\d]+)/.exec(_)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(_)&&(oe=/Android ([\.\_\d]+)/.exec(_)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(_)&&(oe=(oe=/OS (\d+)_(\d+)_?(\d+)?/.exec(j))[1]+"."+oe[2]+"."+(0|oe[3]))}return{osName:N,osVersion:oe}}();ce&&ce.osName&&"-"!=ce.osName?(ge=ce.osName,ye=ce.osVersion):$.any()&&"Android"==(ge=$.getOsName())&&(ye=function(W){var I=(W=(W||l.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/);return!!I&&I[1]}());var J="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===ge&&J&&(ge="Nodejs",ye=process.versions.node.toString().replace("v",""));var Ue=!1,Ge=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(W){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!Ue&&W in document.createElement("canvas")&&(Ue=!0),!Ge&&W in document.createElement("video")&&(Ge=!0))});var $e=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,mt=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,gt=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,Me=[],Te=[],Re=[],xe=[];l.mediaDevices&&l.mediaDevices.enumerateDevices&&(l.enumerateDevices=function(W){var I=l.mediaDevices.enumerateDevices();I&&I.then?l.mediaDevices.enumerateDevices().then(W).catch(function(){W([])}):W([])});var qe=!1;(void 0!==he&&"getSources"in he||l.mediaDevices&&l.mediaDevices.enumerateDevices)&&(qe=!0);var Be=!1,We=!1,Fe=!1,Oe=!1,Pe=!1,M=window.DetectRTC||{};M.browser=function(){var W,I,j,_=l.userAgent,N=l.appName,H=""+parseFloat(l.appVersion),fe=parseInt(l.appVersion,10);if(G&&!z&&-1!==_.indexOf("CriOS")&&(G=!1,z=!0),w){N="Opera";try{fe=(H=l.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(oe){H="0.0.0.0",fe=0}}else K?((I=_.indexOf("rv:"))>0?H=_.substring(I+3):(I=_.indexOf("MSIE"),H=_.substring(I+5)),N="IE"):z?(I=_.indexOf("Chrome"),N="Chrome",H=_.substring(I+7)):G?(I=_.indexOf("Safari"),N="Safari",H=_.substring(I+7),-1!==(I=_.indexOf("Version"))&&(H=_.substring(I+8)),-1!==l.userAgent.indexOf("Version/")&&(H=l.userAgent.split("Version/")[1].split(" ")[0])):T?(I=_.indexOf("Firefox"),N="Firefox",H=_.substring(I+8)):(W=_.lastIndexOf(" ")+1)<(I=_.lastIndexOf("/"))&&(N=_.substring(W,I),H=_.substring(I+1),N.toLowerCase()===N.toUpperCase()&&(N=l.appName));return v&&(N="Edge",H=l.userAgent.split("Edge/")[1]),-1!==(j=H.search(/[; \)]/))&&(H=H.substring(0,j)),fe=parseInt(""+H,10),isNaN(fe)&&(H=""+parseFloat(l.appVersion),fe=parseInt(l.appVersion,10)),{fullVersion:H,version:fe,name:N,isPrivateBrowsing:!1}}(),function(W){var I;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){I=!1},function(_){I=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var j;try{(j=window.indexedDB.open("test")).onerror=function(){return!0}}catch(_){I=!0}void 0===I&&R(function(){return"done"===j.readyState},function(_){_||(I=!j.result)})}else if(function(W){var I=window.navigator.userAgent.toLowerCase();if(0===I.indexOf("msie")&&0===I.indexOf("trident"))return!1;var j=/(?:msie|rv:)\s?([\d\.]+)/.exec(I);return!!(j&&parseInt(j[1],10)>=10)}()){I=!1;try{window.indexedDB||(I=!0)}catch(_){I=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(_){I=!0}void 0===I&&(I=!1,window.localStorage.removeItem("test"))}}catch(_){I=!1}R(function(){return void 0!==I},function(_){!function(W){M.browser.isPrivateBrowsing=!!W}(I)})}(),M.browser["is"+M.browser.name]=!0,M.osName=ge,M.osVersion=ye;var He=("object"==typeof process&&"object"==typeof process.versions&&process,!1);["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(W){He||W in window&&(He=!0)}),M.isWebRTCSupported=He,M.isORTCSupported="undefined"!=typeof RTCIceGatherer;var be=!1;(M.browser.isChrome&&M.browser.version>=35||M.browser.isFirefox&&M.browser.version>=34||M.browser.isEdge&&M.browser.version>=17||"Android"===M.osName&&M.browser.isChrome)&&(be=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||"")||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(M.browser.isChrome||M.browser.isEdge||M.browser.isOpera)||M.browser.isFirefox)&&(be=!1),M.isScreenCapturingSupported=be;var De={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(W){De.isSupported||W in window&&(De.isSupported=!0,window[W]&&"createMediaStreamSource"in window[W].prototype&&(De.isCreateMediaStreamSourceSupported=!0))}),M.isAudioContextSupported=De.isSupported,M.isCreateMediaStreamSourceSupported=De.isCreateMediaStreamSourceSupported;var Qe=!1;M.browser.isChrome&&M.browser.version>31&&(Qe=!0),M.isRtpDataChannelsSupported=Qe;var Ve=!1;(M.browser.isFirefox&&M.browser.version>28||M.browser.isChrome&&M.browser.version>25||M.browser.isOpera&&M.browser.version>=11)&&(Ve=!0),M.isSctpDataChannelsSupported=Ve,M.isMobileDevice=m;var Ae=!1;(l.getUserMedia||l.mediaDevices&&l.mediaDevices.getUserMedia)&&(Ae=!0),M.browser.isChrome&&M.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(Ae="Requires HTTPs"),"Nodejs"===M.osName&&(Ae=!1),M.isGetUserMediaSupported=Ae;var et="";screen.width&&(et+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:"")),M.displayResolution=et,M.displayAspectRatio=function(W,I){var _=function j(N,H){return 0==H?N:j(H,N%H)}(W,I);return W/_/(I/_)}(screen.width,screen.height).toFixed(2),M.isCanvasSupportsStreamCapturing=Ue,M.isVideoSupportsStreamCapturing=Ge,"Chrome"==M.browser.name&&M.browser.version>=53&&(M.isCanvasSupportsStreamCapturing||(M.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),M.isVideoSupportsStreamCapturing||(M.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),M.DetectLocalIPAddress=function(W,I){if(M.isWebRTCSupported){var j=!0,_=!0;!function(W,I){function j(ne){if(ne){var Ee=mt.exec(ne);if(Ee){var ze=Ee[1];ne.match($e);void 0===N[ze]&&W(ze),N[ze]=!0}}else W()}function _(){ve.localDescription.sdp.split("\n").forEach(function(Ee){Ee&&0===Ee.indexOf("a=candidate:")&&j(Ee)})}if("undefined"!=typeof document&&"function"==typeof document.getElementById){var N={},H=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!H){var fe=document.getElementById("iframe");if(!fe)return;var oe=fe.contentWindow;H=oe.RTCPeerConnection||oe.mozRTCPeerConnection||oe.webkitRTCPeerConnection}if(H){var dt=null;"Chrome"===M.browser&&M.browser.version<58&&(dt={optional:[{RtpDataChannels:!0}]});var ve=new H({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},dt);if(I&&(ve.addStream?ve.addStream(I):ve.addTrack&&I.getTracks()[0]&&ve.addTrack(I.getTracks()[0],I)),ve.onicecandidate=function(ne){ne.candidate&&ne.candidate.candidate?j(ne.candidate.candidate):j()},!I)try{ve.createDataChannel("sctp",{})}catch(ne){}M.isPromisesSupported?ve.createOffer().then(function(ne){ve.setLocalDescription(ne).then(_)}):ve.createOffer(function(ne){ve.setLocalDescription(ne,_,function(){})},function(){})}}}(function(N){N?N.match($e)?W("Local: "+N,j=!1,_):(N.match(gt)&&(_=!1),W("Public: "+N,j,_)):W()},I)}},M.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,M.isWebSocketsBlocked=!M.isWebSocketsSupported,"Nodejs"===M.osName&&(M.isWebSocketsSupported=!0,M.isWebSocketsBlocked=!1),M.checkWebSocketsSupport=function(W){W=W||function(){};try{var I,j=new WebSocket("wss://echo.websocket.org:443/");j.onopen=function(){M.isWebSocketsBlocked=!1,I=(new Date).getTime(),j.send("ping")},j.onmessage=function(){M.WebsocketLatency=(new Date).getTime()-I+"ms",W(),j.close(),j=null},j.onerror=function(){M.isWebSocketsBlocked=!0,W()}}catch(_){M.isWebSocketsBlocked=!0,W()}},M.load=function(W){!function(W){if(qe&&(!l.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(l.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!l.enumerateDevices&&l.enumerateDevices&&(l.enumerateDevices=l.enumerateDevices.bind(l)),l.enumerateDevices)){Me=[],Te=[],Re=[],xe=[],Be=!1,We=!1,Fe=!1,Oe=!1,Pe=!1;var I={};l.enumerateDevices(function(j){j.forEach(function(_){var N={};for(var H in _)try{"function"!=typeof _[H]&&(N[H]=_[H])}catch(fe){}I[N.deviceId+N.label+N.kind]||("audio"===N.kind&&(N.kind="audioinput"),"video"===N.kind&&(N.kind="videoinput"),N.deviceId||(N.deviceId=N.id),N.id||(N.id=N.deviceId),N.label?("videoinput"!==N.kind||Pe||(Pe=!0),"audioinput"!==N.kind||Oe||(Oe=!0)):(N.isCustomLabel=!0,N.label="videoinput"===N.kind?"Camera "+(xe.length+1):"audioinput"===N.kind?"Microphone "+(Te.length+1):"audiooutput"===N.kind?"Speaker "+(Re.length+1):"Please invoke getUserMedia once.",void 0!==M&&M.browser.isChrome&&M.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(N.label="HTTPs is required to get label of this "+N.kind+" device.")),"audioinput"===N.kind&&(Be=!0,-1===Te.indexOf(N)&&Te.push(N)),"audiooutput"===N.kind&&(We=!0,-1===Re.indexOf(N)&&Re.push(N)),"videoinput"===N.kind&&(Fe=!0,-1===xe.indexOf(N)&&xe.push(N)),Me.push(N),I[N.deviceId+N.label+N.kind]=N)}),void 0!==M&&(M.MediaDevices=Me,M.hasMicrophone=Be,M.hasSpeakers=We,M.hasWebcam=Fe,M.isWebsiteHasWebcamPermissions=Pe,M.isWebsiteHasMicrophonePermissions=Oe,M.audioInputDevices=Te,M.audioOutputDevices=Re,M.videoInputDevices=xe),W&&W()})}else W&&W()}(W=W||function(){})},M.MediaDevices=void 0!==Me?Me:[],M.hasMicrophone=Be,M.hasSpeakers=We,M.hasWebcam=Fe,M.isWebsiteHasWebcamPermissions=Pe,M.isWebsiteHasMicrophonePermissions=Oe,M.audioInputDevices=Te,M.audioOutputDevices=Re,M.videoInputDevices=xe;var tt=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(tt=!0),M.isSetSinkIdSupported=tt;var je=!1;M.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(je=!0):M.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(je=!0),M.isRTPSenderReplaceTracksSupported=je;var rt=!1;M.browser.isFirefox&&M.browser.version>38&&(rt=!0),M.isRemoteStreamProcessingSupported=rt;var it=!1;void 0!==he&&"applyConstraints"in he.prototype&&(it=!0),M.isApplyConstraintsSupported=it;var at=!1;M.browser.isFirefox&&M.browser.version>=43&&(at=!0),M.isMultiMonitorScreenCapturingSupported=at,M.isPromisesSupported="Promise"in window,M.version="1.3.9",void 0===M&&(window.DetectRTC={});var Le=window.MediaStream;void 0===Le&&"undefined"!=typeof webkitMediaStream&&(Le=webkitMediaStream),M.MediaStream=void 0!==Le&&"function"==typeof Le&&Object.keys(Le.prototype),M.MediaStreamTrack=void 0!==he&&Object.keys(he.prototype);var st=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;M.RTCPeerConnection=void 0!==st&&Object.keys(st.prototype),window.DetectRTC=M,k.exports=M,void 0!==(P=function(){return M}.apply(V,[]))&&(k.exports=P)}(),"undefined"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(d,R,x){d.attachEvent&&d.attachEvent("on"+R,x)}),window.attachEventListener=function(d,R,x,b){d.addEventListener(R,x,b)};var Ce=window.MediaStream;void 0===Ce&&"undefined"!=typeof webkitMediaStream&&(Ce=webkitMediaStream),void 0!==Ce&&("stop"in Ce.prototype||(Ce.prototype.stop=function(){this.getTracks().forEach(function(d){d.stop()})})),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",document.addEventListener("deviceready",Ke,!1),Ke();var ue,ke={};void 0!==window.RTCPeerConnection?ue=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?ue=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(ue=webkitRTCPeerConnection);var Je=window.RTCSessionDescription||window.mozRTCSessionDescription,Xe=window.RTCIceCandidate||window.mozRTCIceCandidate,he=window.MediaStreamTrack,me=function(){function d(m,v){var w=x(m);return w.videoCodecNumbers?"vp8"===v&&w.vp8LineNumber===w.videoCodecNumbers[0]||"vp9"===v&&w.vp9LineNumber===w.videoCodecNumbers[0]||"h264"===v&&w.h264LineNumber===w.videoCodecNumbers[0]?m:m=R(m,v,w):m}function R(m,v,w,T){var G="";if("vp8"===v){if(!w.vp8LineNumber)return m;G=w.vp8LineNumber}if("vp9"===v){if(!w.vp9LineNumber)return m;G=w.vp9LineNumber}if("h264"===v){if(!w.h264LineNumber)return m;G=w.h264LineNumber}var z=w.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",K=[G];return T&&(K=[]),w.videoCodecNumbers.forEach(function($){$!==G&&K.push($)}),z+=K.join(" "),m.replace(w.videoCodecNumbersOriginal,z)}function x(m){var v={};return m.split("\n").forEach(function(w){0===w.indexOf("m=video")&&(v.videoCodecNumbers=[],w.split("SAVPF")[1].split(" ").forEach(function(T){(T=T.trim())&&T.length&&(v.videoCodecNumbers.push(T),v.videoCodecNumbersOriginal=w)})),-1===w.indexOf("VP8/90000")||v.vp8LineNumber||(v.vp8LineNumber=w.replace("a=rtpmap:","").split(" ")[0]),-1===w.indexOf("VP9/90000")||v.vp9LineNumber||(v.vp9LineNumber=w.replace("a=rtpmap:","").split(" ")[0]),-1===w.indexOf("H264/90000")||v.h264LineNumber||(v.h264LineNumber=w.replace("a=rtpmap:","").split(" ")[0])}),v}function g(m,v,w){return function(m,v,w,T,G){for(var z=m.length,K=0;K<z;++K)if(0===m[K].indexOf(T)&&(!G||-1!==m[K].toLowerCase().indexOf(G.toLowerCase())))return K;return null}(m,0,0,v,w)}function F(m){var v=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),w=m.match(v);return w&&2===w.length?w[1]:null}return{removeVPX:function(m){var v=x(m);return m=R(m,"vp9",v,!0),R(m,"vp8",v,!0)},disableNACK:function(m){if(!m||"string"!=typeof m)throw"Invalid arguments.";return(m=(m=(m=m.replace("a=rtcp-fb:126 nack\r\n","")).replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n")).replace("a=rtcp-fb:97 nack\r\n","")).replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n")},prioritize:function(m,v){if(v&&v.getSenders&&v.getSenders().length){if(!m||"string"!=typeof m)throw"Invalid arguments.";v.getSenders().forEach(function(w){for(var T=w.getParameters(),G=0;G<T.codecs.length;G++)if(T.codecs[G].mimeType==m){T.codecs.unshift(T.codecs.splice(G,1));break}w.setParameters(T)})}},removeNonG722:function(m){return m.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(m,v,w){return function(m,v,w){return v&&("undefined"!=typeof isFirefox&&isFirefox||(w&&(v.screen?v.screen<300&&console.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):console.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),v.screen&&w&&(m=(m=m.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+v.screen+"\r\n")),(v.audio||v.video)&&(m=m.replace(/b=AS([^\r\n]+\r\n)/g,"")),v.audio&&(m=m.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+v.audio+"\r\n")),v.screen?m=m.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+v.screen+"\r\n"):v.video&&(m=m.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+v.video+"\r\n")))),m}(m,v,w)},setVideoBitrates:function(m,v){return function(m,v){var w,T=(v=v||{}).min,G=v.max,z=m.split("\r\n"),K=g(z,"a=rtpmap","VP8/90000");if(K&&(w=F(z[K])),!w)return m;var $,ge=g(z,"a=rtpmap","rtx/90000");if(ge&&($=F(z[ge])),!ge)return m;var ye=g(z,"a=fmtp:"+$.toString());if(null!==ye){var ce="\r\n";z[ye]=z[ye].concat(ce+="a=fmtp:"+w+" x-google-min-bitrate="+(T||"228")+"; x-google-max-bitrate="+(G||"228")),m=z.join("\r\n")}return m}(m,v)},setOpusAttributes:function(m,v){return function(m,v){v=v||{};var w,T=m.split("\r\n"),G=g(T,"a=rtpmap","opus/48000");if(G&&(w=F(T[G])),!w)return m;var z=g(T,"a=fmtp:"+w.toString());if(null===z)return m;var K="";return K+="; stereo="+(void 0!==v.stereo?v.stereo:"1"),K+="; sprop-stereo="+(void 0!==v["sprop-stereo"]?v["sprop-stereo"]:"1"),void 0!==v.maxaveragebitrate&&(K+="; maxaveragebitrate="+(v.maxaveragebitrate||1048576)),void 0!==v.maxplaybackrate&&(K+="; maxplaybackrate="+(v.maxplaybackrate||1048576)),void 0!==v.cbr&&(K+="; cbr="+(void 0!==v.cbr?v.cbr:"1")),void 0!==v.useinbandfec&&(K+="; useinbandfec="+v.useinbandfec),void 0!==v.usedtx&&(K+="; usedtx="+v.usedtx),void 0!==v.maxptime&&(K+="\r\na=maxptime:"+v.maxptime),T[z]=T[z].concat(K),T.join("\r\n")}(m,v)},preferVP9:function(m){return d(m,"vp9")},preferCodec:d,forceStereoAudio:function(m){for(var v=m.split("\r\n"),w=null,T=0;T<v.length;T++)if(-1!==v[T].search("opus/48000")){var G=extractSdp(v[T],/:(\d+) opus\/48000/i);break}for(T=0;T<v.length;T++)if(-1!==v[T].search("a=fmtp")&&extractSdp(v[T],/a=fmtp:(\d+)/)===G){w=T;break}return null===w?m:(v[w]=v[w].concat("; stereo=1; sprop-stereo=1"),m=v.join("\r\n"))}}}();window.BandwidthHandler=me;var pt={processCandidates:function(R,x){var b=x.candidate,E=R.candidates,C=E.stun,S=E.turn;if(pe(E.reflexive)||(C=E.reflexive),pe(E.relay)||(S=E.relay),(E.host||!b.match(/typ host/g))&&(S||!b.match(/typ relay/g))&&(C||!b.match(/typ srflx/g))){var L=R.iceProtocols;if((L.udp||!b.match(/ udp /g))&&(L.tcp||!b.match(/ tcp /g)))return R.enableLogs&&console.debug("Your candidate pairs:",b),{candidate:b,sdpMid:x.sdpMid,sdpMLineIndex:x.sdpMLineIndex}}}},vt_getIceServers=function(R){return[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}]};window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(d){this.mutex=!1;var R=this.streams[d];if(R){var x=(R=R.stream).currentUserMediaRequestOptions;this.queueRequests.indexOf(x)&&(delete this.queueRequests[this.queueRequests.indexOf(x)],this.queueRequests=se(this.queueRequests)),this.streams[d].stream=null,delete this.streams[d]}}};var le=function(){function d(b){if(b)return"string"==typeof b||void 0===b?b:b.audio&&b.video?null:b.audio?"audio":b.video?"video":void 0}function x(b,E,C,S){(S=(S||0)+1)>=E||setTimeout(function(){C(),x(b,E,C,S)},b)}return{setHandlers:function(b,E,C){function S(){if(C.streamEvents[b.streamid].mediaElement){var g=C.streamEvents[b.streamid].mediaElement;g.volume=0,x(200,5,function(){try{g.volume+=.2}catch(D){g.volume=1}})}}if(b&&b.addEventListener){if(void 0===E||1==E){var L="ended";"oninactive"in b&&(L="inactive"),b.addEventListener(L,function(){le.onSyncNeeded(this.streamid,L)},!1)}b.mute=function(g,D){g=d(g),void 0!==D&&(E=D),void 0!==g&&"audio"!=g||de(b,"audio").forEach(function(F){F.enabled=!1,C.streamEvents[b.streamid].isAudioMuted=!0}),void 0!==g&&"video"!=g||de(b,"video").forEach(function(F){F.enabled=!1}),void 0!==E&&1!=E||le.onSyncNeeded(b.streamid,"mute",g),C.streamEvents[b.streamid].muteType=g||"both",Z(b,"mute",g)},b.unmute=function(g,D){g=d(g),void 0!==D&&(E=D),S(),void 0!==g&&"audio"!=g||de(b,"audio").forEach(function(F){F.enabled=!0,C.streamEvents[b.streamid].isAudioMuted=!1}),void 0!==g&&"video"!=g||(de(b,"video").forEach(function(F){F.enabled=!0}),void 0!==g&&"video"==g&&C.streamEvents[b.streamid].isAudioMuted&&function F(J){J||(J=0),++J<100&&C.streamEvents[b.streamid].isAudioMuted&&(b.mute("audio"),setTimeout(function(){F(J)},50))}()),void 0!==E&&1!=E||le.onSyncNeeded(b.streamid,"unmute",g),C.streamEvents[b.streamid].unmuteType=g||"both",Z(b,"unmute",g)}}},onSyncNeeded:function(b,E,C){}}}(),ht={send:function(d){var x=d.connection,b=d.channel,E=d.remoteUserId,C=d.text,S=x.chunkSize||1e3,L="",g=!1;(function(d){return"string"==typeof d})(C)||(g=!0,C=JSON.stringify(C));var D=Q(),F=(new Date).getTime();!function R(J,Y){var l={type:"text",uuid:D,sendingTime:F};J&&(Y=J,l.packets=parseInt(Y.length/S)),Y.length>S?l.message=Y.slice(0,S):(l.message=Y,l.last=!0,l.isobject=g),b.send(l,E),(L=Y.slice(l.message.length)).length&&setTimeout(function(){R(null,L)},x.chunkInterval||100)}(C)}},Ye={handle:function(R){var b={};R.onFileStart=function(E){var C=document.createElement("div");return C.title=E.name,C.innerHTML="<label>0%</label> <progress></progress>",E.remoteUserId&&(C.innerHTML+=" (Sharing with:"+E.remoteUserId+")"),R.filesContainer||(R.filesContainer=document.body||document.documentElement),R.filesContainer.insertBefore(C,R.filesContainer.firstChild),E.remoteUserId?(b[E.uuid]||(b[E.uuid]={}),b[E.uuid][E.remoteUserId]={div:C,progress:C.querySelector("progress"),label:C.querySelector("label")},void(b[E.uuid][E.remoteUserId].progress.max=E.maxChunks)):(b[E.uuid]={div:C,progress:C.querySelector("progress"),label:C.querySelector("label")},void(b[E.uuid].progress.max=E.maxChunks))},R.onFileProgress=function(E){var C=b[E.uuid];C&&(E.remoteUserId&&!(C=b[E.uuid][E.remoteUserId])||(C.progress.value=E.currentPosition||E.maxChunks||C.progress.max,function(E,C){if(-1!==E.position){var S=+E.position.toFixed(2).split(".")[1]||100;C.innerHTML=S+"%"}}(C.progress,C.label)))},R.onFileEnd=function(E){var C=b[E.uuid];if(C){if(!E.remoteUserId||(C=b[E.uuid][E.remoteUserId])){C.div.innerHTML=-1!=E.type.indexOf("image")?'<a href="'+E.url+'" download="'+E.name+'">Download <strong style="color:red;">'+E.name+'</strong> </a><br /><img src="'+E.url+'" title="'+E.name+'" style="max-width: 80%;">':'<a href="'+E.url+'" download="'+E.name+'">Download <strong style="color:red;">'+E.name+'</strong> </a><br /><iframe src="'+E.url+'" title="'+E.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}else console.error("No such progress-helper element exist.",E)}}},Ze={handle:function(R){R.autoTranslateText=!1,R.language="en",R.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",R.Translator={TranslateText:function(x,b){var E=document.createElement("script");E.type="text/javascript";var C=encodeURIComponent(x),S="method"+R.token();window[S]=function(g){return g.data&&g.data.translations[0]&&b?void b(g.data.translations[0].translatedText):g.error&&"Daily Limit Exceeded"===g.error.message?void console.error('Text translation failed. Error message: "Daily Limit Exceeded."'):g.error?void console.error(g.error.message):void console.error(g)},E.src="https://www.googleapis.com/language/translate/v2?key="+R.googKey+"&target="+(R.language||"en-US")+"&callback=window."+S+"&q="+C,document.getElementsByTagName("head")[0].appendChild(E)},getListOfLanguages:function(x){var b=new XMLHttpRequest;b.onreadystatechange=function(){if(b.readyState==XMLHttpRequest.DONE){var C=JSON.parse(b.responseText);if(C&&C.data&&C.data.languages)return void x(C.data.languages);if(C.error&&"Daily Limit Exceeded"===C.error.message)return void console.error('Text translation failed. Error message: "Daily Limit Exceeded."');if(C.error)return void console.error(C.error.message);console.error(C)}},b.open("GET","https://www.googleapis.com/language/translate/v2/languages?key="+R.googKey+"&target=en",!0),b.send(null)}}}};!function(d){function x(l){if(d.socketAutoReConnect=!0,d.socket)l&&l(d.socket);else{if(void 0===q)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new q(d,function(m){l&&l(d.socket)})}}function b(l,m){d.socket.emit("join-room",{sessionid:d.sessionid,session:d.session,mediaConstraints:d.mediaConstraints,sdpConstraints:d.sdpConstraints,streams:C(),extra:d.extra,password:void 0!==d.password&&"object"!=typeof d.password?d.password:""},function(v,w){if(!0===v){if(d.enableLogs&&console.log("isRoomJoined: ",v," roomid: ",d.sessionid),d.peers[d.sessionid])return;D.onNegotiationNeeded(l)}!1===v&&d.enableLogs&&console.warn("isRoomJoined: ",w," roomid: ",d.sessionid),m(v,d.sessionid,w)})}function E(l){d.enableLogs&&console.log("Sending open-room signal to socket.io"),d.waitingForLocalMedia=!1,d.socket.emit("open-room",{sessionid:d.sessionid,session:d.session,mediaConstraints:d.mediaConstraints,sdpConstraints:d.sdpConstraints,streams:C(),extra:d.extra,identifier:d.publicRoomIdentifier,password:void 0!==d.password&&"object"!=typeof d.password?d.password:""},function(m,v){!0===m&&(d.enableLogs&&console.log("isRoomOpened: ",m," roomid: ",d.sessionid),l(m,d.sessionid)),!1===m&&(d.enableLogs&&console.warn("isRoomOpened: ",v," roomid: ",d.sessionid),l(m,d.sessionid,v))})}function C(){try{return d.streamEvents.selectAll("local").map(function(l){return{streamid:l.streamid,tracks:l.stream.getTracks().length}})}catch(l){return[]}}function S(l,m){if(!d.dontCaptureUserMedia&&!l.isDataOnly){var v={};l.localPeerSdpConstraints.OfferToReceiveAudio&&(v.audio=d.mediaConstraints.audio),l.localPeerSdpConstraints.OfferToReceiveVideo&&(v.video=d.mediaConstraints.video);var w=l.session||d.session;return w.oneway&&"two-way"!==w.audio&&"two-way"!==w.video&&"two-way"!==w.screen?void m():(w.oneway&&w.audio&&"two-way"===w.audio&&(w={audio:!0}),void((w.audio||w.video||w.screen)&&(w.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:te(d)}).then(function(T){T.isScreen=!0,D.onGettingLocalMedia(T),!w.audio&&!w.video||te(d)?m(T):d.invokeGetUserMedia(null,m)},function(T){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):d.invokeGetUserMedia({audio:te(d),video:!0,isScreen:!0},!w.audio&&!w.video||te(d)?m:d.invokeGetUserMedia(null,m)):(w.audio||w.video)&&d.invokeGetUserMedia(null,m,w))))}m()}function L(l,m){return l?(m.audio&&de(l,"audio").forEach(function(v){v.applyConstraints(m.audio)}),void(m.video&&de(l,"video").forEach(function(v){v.applyConstraints(m.video)}))):void(d.enableLogs&&console.error("No stream to applyConstraints."))}function g(l,m,v){return m?void D.replaceTrack(l,m,v):void d.peers.getAllParticipants().forEach(function(w){D.replaceTrack(l,w,v)})}A=A||{useDefaultDevices:!0},d.channel=d.sessionid=(U||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var D=new X(d),F={};D.onGettingLocalMedia=function(l,m){if(m=m||function(){},F[l.streamid])m();else{F[l.streamid]=!0;try{l.type="local"}catch(v){}d.setStreamEndHandler(l),we(l,function(v){v.id=l.streamid,v.muted=!0,v.volume=0,-1===d.attachStreams.indexOf(l)&&d.attachStreams.push(l),void 0!==le&&le.setHandlers(l,!0,d),d.streamEvents[l.streamid]={stream:l,type:"local",mediaElement:v,userid:d.userid,extra:d.extra,streamid:l.streamid,isAudioMuted:!0};try{(function(d,R){if(R.stream&&de(R.stream,"audio").length){if(!d||!R)throw"Both arguments are required.";if(d.onspeaking&&d.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(R.stream,{onspeaking:function(){d.onspeaking(R)},onsilence:function(){d.onsilence(R)},onvolumechange:function(x,b){d.onvolumechange&&d.onvolumechange(merge({volume:x,threshold:b},R))}})}}})(d,d.streamEvents[l.streamid]),re(d,d.streamEvents[l.streamid]),d.onstream(d.streamEvents[l.streamid])}catch(w){}m()},d)}},D.onGettingRemoteMedia=function(l,m){try{l.type="remote"}catch(v){}d.setStreamEndHandler(l,"remote-stream"),we(l,function(v){v.id=l.streamid,void 0!==le&&le.setHandlers(l,!1,d),d.streamEvents[l.streamid]={stream:l,type:"remote",userid:m,extra:d.peers[m]?d.peers[m].extra:{},mediaElement:v,streamid:l.streamid},re(d,d.streamEvents[l.streamid]),d.onstream(d.streamEvents[l.streamid])},d)},D.onRemovingRemoteMedia=function(l,m){var v=d.streamEvents[l.streamid];v||(v={stream:l,type:"remote",userid:m,extra:d.peers[m]?d.peers[m].extra:{},streamid:l.streamid,mediaElement:d.streamEvents[l.streamid]?d.streamEvents[l.streamid].mediaElement:null}),d.peersBackup[v.userid]&&(v.extra=d.peersBackup[v.userid].extra),d.onstreamended(v),delete d.streamEvents[l.streamid]},D.onNegotiationNeeded=function(l,m,v){v=v||function(){};var w={remoteUserId:m=m||l.remoteUserId,message:l=l||"",sender:d.userid};l.remoteUserId&&l.message&&l.sender&&(w=l),x(function(){d.socket.emit(d.socketMessageEvent,w,v)})},D.onUserLeft=function(l){d.deletePeer(l)},D.disconnectWith=function(l,m){d.socket&&d.socket.emit("disconnect-with",l,m||function(){}),d.deletePeer(l)},d.socketOptions={transport:"polling"},d.openOrJoin=function(l,m){m=m||function(){},d.checkPresence(l,function(v,w){if(!v)return d.waitingForLocalMedia=!0,d.isInitiator=!0,d.sessionid=w||d.sessionid,ie(d.session)?void E(m):void d.captureUserMedia(function(){E(m)});d.sessionid=w;var z=!!d.session.oneway,K=ie(d.session),$={remoteUserId:d.sessionid,message:{newParticipationRequest:!0,isOneWay:z,isDataOnly:K,localPeerSdpConstraints:{OfferToReceiveAudio:z?!!d.session.audio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:z?!!d.session.video||!!d.session.screen:d.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.sdpConstraints.mandatory.OfferToReceiveVideo}},sender:d.userid};S($.message,function(){b($,m)})})},d.waitingForLocalMedia=!1,d.open=function(l,m){m=m||function(){},d.waitingForLocalMedia=!0,d.isInitiator=!0,d.sessionid=l||d.sessionid,x(function(){return ie(d.session)?void E(m):void d.captureUserMedia(function(){E(m)})})},d.peersBackup={},d.deletePeer=function(l){if(l&&d.peers[l]){var m={userid:l,extra:d.peers[l]?d.peers[l].extra:{}};if(d.peersBackup[m.userid]&&(m.extra=d.peersBackup[m.userid].extra),d.onleave(m),d.peers[l]){d.peers[l].streams.forEach(function(w){w.stop()});var v=d.peers[l].peer;if(v&&"closed"!==v.iceConnectionState)try{v.close()}catch(w){}d.peers[l]&&(d.peers[l].peer=null,delete d.peers[l])}}},d.rejoin=function(l){if(!d.isInitiator&&l&&Object.keys(l).length){var m={};d.peers[l.remoteUserId]&&(m=d.peers[l.remoteUserId].extra,d.deletePeer(l.remoteUserId)),l&&l.remoteUserId&&(d.join(l.remoteUserId),d.onReConnecting({userid:l.remoteUserId,extra:m}))}},d.join=function(l,m){d.sessionid=!!l&&(l.sessionid||l.remoteUserId||l)||d.sessionid,d.sessionid+="";var v=!1,w=!1,T=!1,G=!1;if(l&&l.session||!l||"string"==typeof l){var z=l&&l.session||d.session;T=!!z.oneway,G=ie(z),w={OfferToReceiveAudio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.sdpConstraints.mandatory.OfferToReceiveVideo},v={OfferToReceiveAudio:T?!!d.session.audio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:T?!!d.session.video||!!d.session.screen:d.sdpConstraints.mandatory.OfferToReceiveVideo}}var K=function(){};"function"==typeof(m=m||{})&&(K=m,m={}),void 0!==m.localPeerSdpConstraints&&(v=m.localPeerSdpConstraints),void 0!==m.remotePeerSdpConstraints&&(w=m.remotePeerSdpConstraints),void 0!==m.isOneWay&&(T=m.isOneWay),void 0!==m.isDataOnly&&(G=m.isDataOnly);var $={remoteUserId:d.sessionid,message:{newParticipationRequest:!0,isOneWay:T,isDataOnly:G,localPeerSdpConstraints:v,remotePeerSdpConstraints:w},sender:d.userid};return S($.message,function(){x(function(){b($,K)})}),$},d.publicRoomIdentifier="",d.getUserMedia=d.captureUserMedia=function(l,m){l=l||function(){};var v=m||d.session;return d.dontCaptureUserMedia||ie(v)?void l():void((v.audio||v.video||v.screen)&&(v.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:te(d)}).then(function(w){if(w.isScreen=!0,D.onGettingLocalMedia(w),!v.audio&&!v.video||te(d))l(w);else{var T={};for(var G in v)"screen"!==G&&(T[G]=v[G]);d.invokeGetUserMedia(m,l,T)}},function(w){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):d.invokeGetUserMedia({audio:te(d),video:!0,isScreen:!0},function(w){if(!v.audio&&!v.video||te(d))l(w);else{var T={};for(var G in v)"screen"!==G&&(T[G]=v[G]);d.invokeGetUserMedia(m,l,T)}}):(v.audio||v.video)&&d.invokeGetUserMedia(m,l,v)))},d.onbeforeunload=function(l,m){d.closeBeforeUnload&&(d.peers.getAllParticipants().forEach(function(v){D.onNegotiationNeeded({userLeft:!0},v),d.peers[v]&&d.peers[v].peer&&d.peers[v].peer.close(),delete d.peers[v]}),m||d.closeSocket(),d.isInitiator=!1)},window.ignoreBeforeUnload?d.closeBeforeUnload=!1:(d.closeBeforeUnload=!0,window.addEventListener("beforeunload",d.onbeforeunload,!1)),d.userid=Q(),d.changeUserId=function(l,m){m=m||function(){},d.userid=l||Q(),d.socket.emit("changed-uuid",d.userid,m)},d.extra={},d.attachStreams=[],d.session={audio:!0,video:!0},d.enableFileSharing=!1,d.bandwidth={screen:!1,audio:!1,video:!1},d.codecs={audio:"opus",video:"VP9"},d.processSdp=function(l){return function(){var d=!1;try{if("undefined"==typeof RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var R=new ue;try{R.addTransceiver("audio"),d=!0}catch(x){}R.close()}catch(x){d=!1}return d&&function(){var d=!1;try{var R=new ue({sdpSemantics:"unified-plan"});try{d="unified-plan"==R.getConfiguration().sdpSemantics||!1}catch(b){d=!1}}catch(b){d=!1}return d}()}()||"Safari"===DetectRTC.browser.name||("VP8"===d.codecs.video.toUpperCase()&&(l=me.preferCodec(l,"vp8")),"VP9"===d.codecs.video.toUpperCase()&&(l=me.preferCodec(l,"vp9")),"H264"===d.codecs.video.toUpperCase()&&(l=me.preferCodec(l,"h264")),"G722"===d.codecs.audio&&(l=me.removeNonG722(l)),"Firefox"===DetectRTC.browser.name||((d.bandwidth.video||d.bandwidth.screen)&&(l=me.setApplicationSpecificBandwidth(l,d.bandwidth,!!d.session.screen)),d.bandwidth.video&&(l=me.setVideoBitrates(l,{min:8*d.bandwidth.video*1024,max:8*d.bandwidth.video*1024})),d.bandwidth.audio&&(l=me.setOpusAttributes(l,{maxaveragebitrate:8*d.bandwidth.audio*1024,maxplaybackrate:8*d.bandwidth.audio*1024,stereo:1,maxptime:3})))),l},void 0!==me&&(d.BandwidthHandler=d.CodecsHandler=me),d.mediaConstraints={audio:{mandatory:{},optional:d.bandwidth.audio?[{bandwidth:8*d.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:d.bandwidth.video?[{bandwidth:8*d.bandwidth.video*1024||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(d.mediaConstraints={audio:!0,video:!0}),A.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load(function(){var l,m;if(DetectRTC.MediaDevices.forEach(function(w){"audioinput"===w.kind&&!1!==d.mediaConstraints.audio&&(l=w),"videoinput"===w.kind&&!1!==d.mediaConstraints.video&&(m=w)}),l){if("Firefox"===DetectRTC.browser.name)return void(!0!==d.mediaConstraints.audio?d.mediaConstraints.audio.deviceId=l.id:d.mediaConstraints.audio={deviceId:l.id});1==d.mediaConstraints.audio&&(d.mediaConstraints.audio={mandatory:{},optional:[]}),d.mediaConstraints.audio.optional||(d.mediaConstraints.audio.optional=[]),d.mediaConstraints.audio.optional=[{sourceId:l.id}].concat(d.mediaConstraints.audio.optional)}if(m){if("Firefox"===DetectRTC.browser.name)return void(!0!==d.mediaConstraints.video?d.mediaConstraints.video.deviceId=m.id:d.mediaConstraints.video={deviceId:m.id});1==d.mediaConstraints.video&&(d.mediaConstraints.video={mandatory:{},optional:[]}),d.mediaConstraints.video.optional||(d.mediaConstraints.video.optional=[]),d.mediaConstraints.video.optional=[{sourceId:m.id}].concat(d.mediaConstraints.video.optional)}}),d.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},d.sdpSemantics=null,d.iceCandidatePoolSize=null,d.bundlePolicy=null,d.rtcpMuxPolicy=null,d.iceTransportPolicy=null,d.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},d.iceServers=vt_getIceServers(d),d.candidates={host:!0,stun:!0,turn:!0},d.iceProtocols={tcp:!0,udp:!0},d.onopen=function(l){d.enableLogs&&console.info("Data connection has been opened between you & ",l.userid)},d.onclose=function(l){d.enableLogs&&console.warn("Data connection has been closed between you & ",l.userid)},d.onerror=function(l){d.enableLogs&&console.error(l.userid,"data-error",l)},d.onmessage=function(l){d.enableLogs&&console.debug("data-message",l.userid,l.data)},d.send=function(l,m){d.peers.send(l,m)},d.close=d.disconnect=d.leave=function(){d.onbeforeunload(!1,!0)},d.closeEntireSession=function(l){l=l||function(){},d.socket.emit("close-entire-session",function m(){return d.getAllParticipants().length?void setTimeout(m,100):(d.onEntireSessionClosed({sessionid:d.sessionid,userid:d.userid,extra:d.extra}),void d.changeUserId(null,function(){d.close(),l()}))})},d.onEntireSessionClosed=function(l){d.enableLogs&&console.info("Entire session is closed: ",l.sessionid,l.extra)},d.onstream=function(l){var m=d.videosContainer;m.insertBefore(l.mediaElement,m.firstChild);var v=l.mediaElement.play();return void 0!==v?void v.catch(function(){}).then(function(){setTimeout(function(){l.mediaElement.play()},2e3)}):void setTimeout(function(){l.mediaElement.play()},2e3)},d.onstreamended=function(l){l.mediaElement||(l.mediaElement=document.getElementById(l.streamid)),l.mediaElement&&l.mediaElement.parentNode&&l.mediaElement.parentNode.removeChild(l.mediaElement)},d.direction="many-to-many",d.removeStream=function(l,m){var v;return d.attachStreams.forEach(function(w){w.id===l&&(v=w)}),v?(d.peers.getAllParticipants().forEach(function(w){if(!m||w===m){var T=d.peers[w];try{T.peer.removeStream(v)}catch(G){}}}),void d.renegotiate()):void console.warn("No such stream exist.",l)},d.addStream=function(l,m){function v(w){l.streamCallback&&l.streamCallback(w),d.renegotiate(m)}return l.getTracks?(-1===d.attachStreams.indexOf(l)&&(l.streamid||(l.streamid=l.id),d.attachStreams.push(l)),void d.renegotiate(m)):ie(l)?void d.renegotiate(m):void((l.audio||l.video||l.screen)&&(l.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:te(d)}).then(function(w){w.isScreen=!0,D.onGettingLocalMedia(w),!l.audio&&!l.video||te(d)?v(w):d.invokeGetUserMedia(null,function(T){v(T)})},function(w){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):d.invokeGetUserMedia({audio:te(d),video:!0,isScreen:!0},function(w){!l.audio&&!l.video||te(d)?v(w):d.invokeGetUserMedia(null,function(T){v(T)})}):(l.audio||l.video)&&d.invokeGetUserMedia(null,v)))},d.invokeGetUserMedia=function(l,m,v){v||(v=d.session),l||(l=d.mediaConstraints),_e({onGettingLocalMedia:function(w){var T=l.video;T&&(T.mediaSource||T.mozMediaSource||T.mandatory&&T.mandatory.chromeMediaSource)&&(w.isScreen=!0),w.isScreen||(w.isVideo=!!de(w,"video").length,w.isAudio=!w.isVideo&&de(w,"audio").length),D.onGettingLocalMedia(w,function(){"function"==typeof m&&m(w)})},onLocalMediaError:function(w,T){D.onLocalMediaError(w,T)},localMediaConstraints:l||{audio:!!v.audio&&l.audio,video:!!v.video&&l.video}})},d.applyConstraints=function(l,m){if(he&&he.prototype.applyConstraints){var v;if(m)return d.streamEvents[m]&&(v=d.streamEvents[m].stream),void L(v,l);d.attachStreams.forEach(function(w){L(w,l)})}else alert("track.applyConstraints is NOT supported in your browser.")},d.replaceTrack=function(l,m,v){function w(T){d.replaceTrack(T,m,v||l.video||l.screen)}if(l=l||{},ue.prototype.getSenders)if(l instanceof he)g(l,m,v);else{if(l instanceof Ce)return de(l,"video").length&&g(de(l,"video")[0],m,!0),void(de(l,"audio").length&&g(de(l,"audio")[0],m,!1));if(ie(l))throw"connection.replaceTrack requires audio and/or video and/or screen.";(l.audio||l.video||l.screen)&&(l.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:te(d)}).then(function(T){T.isScreen=!0,D.onGettingLocalMedia(T),!l.audio&&!l.video||te(d)?w(T):d.invokeGetUserMedia(null,w)},function(T){console.error("Unable to capture screen on Edge. HTTPs and version 17+ is required.")}):d.invokeGetUserMedia({audio:te(d),video:!0,isScreen:!0},!l.audio&&!l.video||te(d)?w:d.invokeGetUserMedia(null,w)):(l.audio||l.video)&&d.invokeGetUserMedia(null,w))}else d.addStream(l)},d.resetTrack=function(l,m){l||(l=d.getAllParticipants()),"string"==typeof l&&(l=[l]),l.forEach(function(v){var w=d.peers[v].peer;void 0!==m&&!0!==m||!w.lastVideoTrack||d.replaceTrack(w.lastVideoTrack,v,!0),void 0!==m&&!1!==m||!w.lastAudioTrack||d.replaceTrack(w.lastAudioTrack,v,!1)})},d.renegotiate=function(l){return l?void D.renegotiatePeer(l):void d.peers.getAllParticipants().forEach(function(m){D.renegotiatePeer(m)})},d.setStreamEndHandler=function(l,m){if(l&&l.addEventListener&&(m=!!m,!l.alreadySetEndHandler)){l.alreadySetEndHandler=!0;var v="ended";"oninactive"in l&&(v="inactive"),l.addEventListener(v,function(){if(l.idInstance&&currentUserMediaRequest.remove(l.idInstance),!m){var w=[];d.attachStreams.forEach(function(z){z.id!=l.id&&w.push(z)}),d.attachStreams=w}var T=d.streamEvents[l.streamid];T||(T={stream:l,streamid:l.streamid,type:m?"remote":"local",userid:d.userid,extra:d.extra,mediaElement:d.streamEvents[l.streamid]?d.streamEvents[l.streamid].mediaElement:null}),m&&d.peers[T.userid]&&(w=[],d.peers[T.userid].peer.getRemoteStreams().forEach(function(K){K.id!=l.id&&w.push(K)}),d.peers[T.userid].streams=w),T.userid===d.userid&&"remote"===T.type||(d.peersBackup[T.userid]&&(T.extra=d.peersBackup[T.userid].extra),d.onstreamended(T),delete d.streamEvents[l.streamid])},!1)}},d.onMediaError=function(l,m){d.enableLogs&&console.error(l,m)},d.autoCloseEntireSession=!1,d.filesContainer=d.videosContainer=document.body||document.documentElement,d.isInitiator=!1,d.shareFile=D.shareFile,void 0!==Ye&&Ye.handle(d),void 0!==Ze&&Ze.handle(d),d.token=Q,d.onNewParticipant=function(l,m){d.acceptParticipationRequest(l,m)},d.acceptParticipationRequest=function(l,m){m.successCallback&&(m.successCallback(),delete m.successCallback),D.createNewPeer(l,m)},void 0!==le&&(d.StreamsHandler=le),d.onleave=function(l){},d.invokeSelectFileDialog=function(l){var m=new FileSelector;m.accept="*.*",m.selectSingleFile(l)},d.onmute=function(l){if(l&&l.mediaElement)if("both"===l.muteType||"video"===l.muteType){l.mediaElement.src=null;var m=l.mediaElement.pause();void 0!==m?m.then(function(){l.mediaElement.poster=l.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}):l.mediaElement.poster=l.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}else"audio"===l.muteType&&(l.mediaElement.muted=!0)},d.onunmute=function(l){l&&l.mediaElement&&l.stream&&("both"===l.unmuteType||"video"===l.unmuteType?(l.mediaElement.poster=null,l.mediaElement.srcObject=l.stream,l.mediaElement.play()):"audio"===l.unmuteType&&(l.mediaElement.muted=!1))},d.onExtraDataUpdated=function(l){l.status="online",d.onUserStatusChanged(l,!0)},d.getAllParticipants=function(l){return d.peers.getAllParticipants(l)},void 0!==le&&(le.onSyncNeeded=function(l,m,v){d.peers.getAllParticipants().forEach(function(w){D.onNegotiationNeeded({streamid:l,action:m,streamSyncNeeded:!0,type:v||"both"},w)})}),d.connectSocket=function(l){x(l)},d.closeSocket=function(){try{io.sockets={}}catch(l){}d.socket&&("function"==typeof d.socket.disconnect&&d.socket.disconnect(),"function"==typeof d.socket.resetProps&&d.socket.resetProps(),d.socket=null)},d.getSocket=function(l){return!l&&d.enableLogs&&console.warn("getSocket.callback paramter is required."),l=l||function(){},d.socket?l(d.socket):x(function(){l(d.socket)}),d.socket},d.getRemoteStreams=D.getRemoteStreams;var J=["selectFirst","selectAll","forEach"];if(d.streamEvents={selectFirst:function(l){return d.streamEvents.selectAll(l)[0]},selectAll:function(l){l||(l={local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0}),"local"==l&&(l={local:!0}),"remote"==l&&(l={remote:!0}),"screen"==l&&(l={isScreen:!0}),"audio"==l&&(l={isAudio:!0}),"video"==l&&(l={isVideo:!0});var m=[];return Object.keys(d.streamEvents).forEach(function(v){var w=d.streamEvents[v];if(-1===J.indexOf(v)){var T=!0;l.local&&"local"===w.type&&(T=!1),l.remote&&"remote"===w.type&&(T=!1),l.isScreen&&w.stream.isScreen&&(T=!1),l.isVideo&&w.stream.isVideo&&(T=!1),l.isAudio&&w.stream.isAudio&&(T=!1),l.userid&&w.userid===l.userid&&(T=!1),!1===T&&m.push(w)}}),m}},d.socketURL="/",d.socketMessageEvent="RTCMultiConnection-Message",d.socketCustomEvent="RTCMultiConnection-Custom-Message",d.DetectRTC=DetectRTC,d.setCustomSocketEvent=function(l){l&&(d.socketCustomEvent=l),d.socket&&d.socket.emit("set-custom-socket-event-listener",d.socketCustomEvent)},d.getNumberOfBroadcastViewers=function(l,m){d.socket&&l&&m&&d.socket.emit("get-number-of-users-in-specific-broadcast",l,m)},d.onNumberOfBroadcastViewersUpdated=function(l){d.enableLogs&&d.isInitiator&&console.info("Number of broadcast (",l.broadcastId,") viewers",l.numberOfBroadcastViewers)},d.onUserStatusChanged=function(l,m){d.enableLogs&&!m&&console.info(l.userid,l.status)},d.getUserMediaHandler=_e,d.multiPeersHandler=D,d.enableLogs=!0,d.setCustomSocketHandler=function(l){void 0!==q&&(q=l)},d.chunkSize=4e4,d.maxParticipantsAllowed=1e3,d.disconnectWith=D.disconnectWith,d.checkPresence=function(l,m){return l=l||d.sessionid,"SSEConnection"===q.name?void SSEConnection.checkPresence(l,function(v,w,T){return d.socket?void m(v,w):(v||(d.userid=w),void d.connectSocket(function(){m(v,w,T)}))}):d.socket?void d.socket.emit("check-presence",l+"",function(v,w,T){d.enableLogs&&console.log("checkPresence.isRoomExist: ",v," roomid: ",w),m(v,w,T)}):void d.connectSocket(function(){d.checkPresence(l,m)})},d.onReadyForOffer=function(l,m){d.multiPeersHandler.createNewPeer(l,m)},d.setUserPreferences=function(l){return d.dontAttachStream&&(l.dontAttachLocalStream=!0),d.dontGetRemoteStream&&(l.dontGetRemoteStream=!0),l},d.updateExtraData=function(){d.socket.emit("extra-data-updated",d.extra)},d.enableScalableBroadcast=!1,d.maxRelayLimitPerUser=3,d.dontCaptureUserMedia=!1,d.dontAttachStream=!1,d.dontGetRemoteStream=!1,d.onReConnecting=function(l){d.enableLogs&&console.info("ReConnecting with",l.userid,"...")},d.beforeAddingStream=function(l){return l},d.beforeRemovingStream=function(l){return l},"undefined"!=typeof isChromeExtensionAvailable&&(d.checkIfChromeExtensionAvailable=isChromeExtensionAvailable),"undefined"!=typeof isFirefoxExtensionAvailable&&(d.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),"undefined"!=typeof getChromeExtensionStatus&&(d.getChromeExtensionStatus=getChromeExtensionStatus),d.modifyScreenConstraints=function(l){return l},d.onPeerStateChanged=function(l){d.enableLogs&&-1!==l.iceConnectionState.search(/closed|failed/gi)&&console.error("Peer connection is closed between you & ",l.userid,l.extra,"state:",l.iceConnectionState)},d.isOnline=!0,ee("online",function(){d.isOnline=!0}),ee("offline",function(){d.isOnline=!1}),d.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(d.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),d.isLowBandwidth)){if(d.bandwidth={audio:!1,video:!1,screen:!1},d.mediaConstraints.audio&&d.mediaConstraints.audio.optional&&d.mediaConstraints.audio.optional.length){var Y=[];d.mediaConstraints.audio.optional.forEach(function(l){void 0===l.bandwidth&&Y.push(l)}),d.mediaConstraints.audio.optional=Y}d.mediaConstraints.video&&d.mediaConstraints.video.optional&&d.mediaConstraints.video.optional.length&&(Y=[],d.mediaConstraints.video.optional.forEach(function(m){void 0===m.bandwidth&&Y.push(m)}),d.mediaConstraints.video.optional=Y)}d.getExtraData=function(l,m){if(!l)throw"remoteUserId is required.";return"function"==typeof m?void d.socket.emit("get-remote-user-extra-data",l,function(v,w,T){m(v,w,T)}):d.peers[l]?d.peers[l].extra:d.peersBackup[l]?d.peersBackup[l].extra:{}},A.autoOpenOrJoin&&d.openOrJoin(d.sessionid),d.onUserIdAlreadyTaken=function(l,m){d.close(),d.closeSocket(),d.isInitiator=!1,d.userid=d.token(),d.join(d.sessionid),d.enableLogs&&console.warn("Userid already taken.",l,"Your new userid:",d.userid)},d.trickleIce=!0,d.version="3.6.9",d.onSettingLocalDescription=function(l){d.enableLogs&&console.info("Set local description for remote user",l.userid)},d.resetScreen=function(){sourceId=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},d.autoCreateMediaElement=!0,d.password=null,d.setPassword=function(l,m){m=m||function(){},d.socket?d.socket.emit("set-password",l,m):(d.password=l,m(!0,d.sessionid,null))},d.onSocketDisconnect=function(l){d.enableLogs&&console.warn("socket.io connection is closed")},d.onSocketError=function(l){d.enableLogs&&console.warn("socket.io connection is failed")},d.errors={ROOM_NOT_AVAILABLE:"Room not available",INVALID_PASSWORD:"Invalid password",USERID_NOT_AVAILABLE:"User ID does not exist",ROOM_PERMISSION_DENIED:"Room permission denied",ROOM_FULL:"Room full",DID_NOT_JOIN_ANY_ROOM:"Did not join any room yet",INVALID_SOCKET:"Invalid socket",PUBLIC_IDENTIFIER_MISSING:"publicRoomIdentifier is required",INVALID_ADMIN_CREDENTIAL:"Invalid username or password attempted"}}(this)};k.exports=V=B,void 0!==(P=function(){return B}.apply(V,[]))&&(k.exports=P)},663:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";function t(k){k?(f[0]=f[16]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=0,this.blocks=f):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}var h="object"==typeof window?window:{},s=!h.JS_SHA1_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;s&&(h=global);var i=!h.JS_SHA1_NO_COMMON_JS&&module.exports,e=__webpack_require__.amdO,r="0123456789abcdef".split(""),o=[-2147483648,8388608,32768,128],n=[24,16,8,0],a=["hex","array","digest","arrayBuffer"],f=[],u=function(k){return function(V){return new t(!0).update(V)[k]()}},c=function(){var k=u("hex");s&&(k=p(k)),k.create=function(){return new t},k.update=function(P){return k.create().update(P)};for(var V=0;V<a.length;++V){var O=a[V];k[O]=u(O)}return k},p=function(t){var h=eval("require('crypto')"),s=eval("require('buffer').Buffer"),i=function(k){if("string"==typeof k)return h.createHash("sha1").update(k,"utf8").digest("hex");if(k.constructor===ArrayBuffer)k=new Uint8Array(k);else if(void 0===k.length)return t(k);return h.createHash("sha1").update(new s(k)).digest("hex")};return i};t.prototype.update=function(k){if(!this.finalized){var V="string"!=typeof k;V&&k.constructor===h.ArrayBuffer&&(k=new Uint8Array(k));for(var O,P,B=0,U=k.length||0,A=this.blocks;B<U;){if(this.hashed&&(this.hashed=!1,A[0]=this.block,A[16]=A[1]=A[2]=A[3]=A[4]=A[5]=A[6]=A[7]=A[8]=A[9]=A[10]=A[11]=A[12]=A[13]=A[14]=A[15]=0),V)for(P=this.start;B<U&&P<64;++B)A[P>>2]|=k[B]<<n[3&P++];else for(P=this.start;B<U&&P<64;++B)(O=k.charCodeAt(B))<128?A[P>>2]|=O<<n[3&P++]:O<2048?(A[P>>2]|=(192|O>>6)<<n[3&P++],A[P>>2]|=(128|63&O)<<n[3&P++]):O<55296||O>=57344?(A[P>>2]|=(224|O>>12)<<n[3&P++],A[P>>2]|=(128|O>>6&63)<<n[3&P++],A[P>>2]|=(128|63&O)<<n[3&P++]):(O=65536+((1023&O)<<10|1023&k.charCodeAt(++B)),A[P>>2]|=(240|O>>18)<<n[3&P++],A[P>>2]|=(128|O>>12&63)<<n[3&P++],A[P>>2]|=(128|O>>6&63)<<n[3&P++],A[P>>2]|=(128|63&O)<<n[3&P++]);this.lastByteIndex=P,this.bytes+=P-this.start,P>=64?(this.block=A[16],this.start=P-64,this.hash(),this.hashed=!0):this.start=P}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var k=this.blocks,V=this.lastByteIndex;k[16]=this.block,k[V>>2]|=o[3&V],this.block=k[16],V>=56&&(this.hashed||this.hash(),k[0]=this.block,k[16]=k[1]=k[2]=k[3]=k[4]=k[5]=k[6]=k[7]=k[8]=k[9]=k[10]=k[11]=k[12]=k[13]=k[14]=k[15]=0),k[14]=this.hBytes<<3|this.bytes>>>29,k[15]=this.bytes<<3,this.hash()}},t.prototype.hash=function(){var k,V,O=this.h0,P=this.h1,B=this.h2,U=this.h3,A=this.h4,q=this.blocks;for(k=16;k<80;++k)q[k]=(V=q[k-3]^q[k-8]^q[k-14]^q[k-16])<<1|V>>>31;for(k=0;k<20;k+=5)O=(V=(P=(V=(B=(V=(U=(V=(A=(V=O<<5|O>>>27)+(P&B|~P&U)+A+1518500249+q[k]<<0)<<5|A>>>27)+(O&(P=P<<30|P>>>2)|~O&B)+U+1518500249+q[k+1]<<0)<<5|U>>>27)+(A&(O=O<<30|O>>>2)|~A&P)+B+1518500249+q[k+2]<<0)<<5|B>>>27)+(U&(A=A<<30|A>>>2)|~U&O)+P+1518500249+q[k+3]<<0)<<5|P>>>27)+(B&(U=U<<30|U>>>2)|~B&A)+O+1518500249+q[k+4]<<0,B=B<<30|B>>>2;for(;k<40;k+=5)O=(V=(P=(V=(B=(V=(U=(V=(A=(V=O<<5|O>>>27)+(P^B^U)+A+1859775393+q[k]<<0)<<5|A>>>27)+(O^(P=P<<30|P>>>2)^B)+U+1859775393+q[k+1]<<0)<<5|U>>>27)+(A^(O=O<<30|O>>>2)^P)+B+1859775393+q[k+2]<<0)<<5|B>>>27)+(U^(A=A<<30|A>>>2)^O)+P+1859775393+q[k+3]<<0)<<5|P>>>27)+(B^(U=U<<30|U>>>2)^A)+O+1859775393+q[k+4]<<0,B=B<<30|B>>>2;for(;k<60;k+=5)O=(V=(P=(V=(B=(V=(U=(V=(A=(V=O<<5|O>>>27)+(P&B|P&U|B&U)+A-1894007588+q[k]<<0)<<5|A>>>27)+(O&(P=P<<30|P>>>2)|O&B|P&B)+U-1894007588+q[k+1]<<0)<<5|U>>>27)+(A&(O=O<<30|O>>>2)|A&P|O&P)+B-1894007588+q[k+2]<<0)<<5|B>>>27)+(U&(A=A<<30|A>>>2)|U&O|A&O)+P-1894007588+q[k+3]<<0)<<5|P>>>27)+(B&(U=U<<30|U>>>2)|B&A|U&A)+O-1894007588+q[k+4]<<0,B=B<<30|B>>>2;for(;k<80;k+=5)O=(V=(P=(V=(B=(V=(U=(V=(A=(V=O<<5|O>>>27)+(P^B^U)+A-899497514+q[k]<<0)<<5|A>>>27)+(O^(P=P<<30|P>>>2)^B)+U-899497514+q[k+1]<<0)<<5|U>>>27)+(A^(O=O<<30|O>>>2)^P)+B-899497514+q[k+2]<<0)<<5|B>>>27)+(U^(A=A<<30|A>>>2)^O)+P-899497514+q[k+3]<<0)<<5|P>>>27)+(B^(U=U<<30|U>>>2)^A)+O-899497514+q[k+4]<<0,B=B<<30|B>>>2;this.h0=this.h0+O<<0,this.h1=this.h1+P<<0,this.h2=this.h2+B<<0,this.h3=this.h3+U<<0,this.h4=this.h4+A<<0},t.prototype.hex=function(){this.finalize();var k=this.h0,V=this.h1,O=this.h2,P=this.h3,B=this.h4;return r[k>>28&15]+r[k>>24&15]+r[k>>20&15]+r[k>>16&15]+r[k>>12&15]+r[k>>8&15]+r[k>>4&15]+r[15&k]+r[V>>28&15]+r[V>>24&15]+r[V>>20&15]+r[V>>16&15]+r[V>>12&15]+r[V>>8&15]+r[V>>4&15]+r[15&V]+r[O>>28&15]+r[O>>24&15]+r[O>>20&15]+r[O>>16&15]+r[O>>12&15]+r[O>>8&15]+r[O>>4&15]+r[15&O]+r[P>>28&15]+r[P>>24&15]+r[P>>20&15]+r[P>>16&15]+r[P>>12&15]+r[P>>8&15]+r[P>>4&15]+r[15&P]+r[B>>28&15]+r[B>>24&15]+r[B>>20&15]+r[B>>16&15]+r[B>>12&15]+r[B>>8&15]+r[B>>4&15]+r[15&B]},t.prototype.toString=t.prototype.hex,t.prototype.digest=function(){this.finalize();var k=this.h0,V=this.h1,O=this.h2,P=this.h3,B=this.h4;return[k>>24&255,k>>16&255,k>>8&255,255&k,V>>24&255,V>>16&255,V>>8&255,255&V,O>>24&255,O>>16&255,O>>8&255,255&O,P>>24&255,P>>16&255,P>>8&255,255&P,B>>24&255,B>>16&255,B>>8&255,255&B]},t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=function(){this.finalize();var k=new ArrayBuffer(20),V=new DataView(k);return V.setUint32(0,this.h0),V.setUint32(4,this.h1),V.setUint32(8,this.h2),V.setUint32(12,this.h3),V.setUint32(16,this.h4),k};var y=c();i?module.exports=y:(h.sha1=y,e&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return y}.call(exports,__webpack_require__,exports,module),void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))})()}}]);